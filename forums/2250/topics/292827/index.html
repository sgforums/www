<!DOCTYPE html>
<html lang='en'>
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PK63DK');</script>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <meta charset='utf-8'>
    <meta content='width=device-width, initial-scale=1, shrink-to-fit=no' name='viewport'>
    <link crossorigin='anonymous' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css' integrity='sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB' rel='stylesheet'>
    <link href='/styles.css' rel='stylesheet'>
    <title>I need some programming guidance.</title>
    <script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script><script>var googletag=googletag ||{}; googletag.cmd=googletag.cmd || [];</script><script>googletag.cmd.push(function(){googletag.defineSlot('\/1010898\/sgforums_interstitial', [ 1.0 , 1.0], 'div-gpt-ad-1528181032761-0').setTargeting('forum', ['2250']).setTargeting('topic', ['292827']).addService(googletag.pubads()); googletag.defineSlot('\/1010898\/sgforums_leaderboard', [[ 728.0 , 90.0], [ 970.0 , 250.0]], 'div-gpt-ad-1528181032761-1').setTargeting('forum', ['2250']).setTargeting('topic', ['292827']).addService(googletag.pubads()); googletag.defineSlot('\/1010898\/sgforums_mpu', [ 300.0 , 250.0], 'div-gpt-ad-1528181032761-2').setTargeting('forum', ['2250']).setTargeting('topic', ['292827']).addService(googletag.pubads()); googletag.defineSlot('\/1010898\/sgforums_supersky', [ 160.0 , 600.0], 'div-gpt-ad-1528181032761-3').setTargeting('forum', ['2250']).setTargeting('topic', ['292827']).addService(googletag.pubads()); googletag.pubads().enableSingleRequest(); googletag.enableServices();});</script>
  </head>
  <body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PK63DK"height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div class='container'>
      <a href='/'>Home</a>
      >
      <a href='/forums/2250/'>IT Support and Tech Corner</a>
      <h1>I need some programming guidance.</h1>
      <nav class='pagination'>
      </nav>
      <ul class='list-group posts'>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>LatecomerX</div>
              <time class='date' datetime='2007-11-22T01:07:01+00:00'>22 Nov 07, 01:07</time>
            </div>
            <div class='col-md body'>Can any programming expert here explain to me why this snippet of PHP code results in an error:<br><br><div>code:<pre><br><br>$db = require_once 'DB.php'; // returns a MySQLi connection object<br>$user = 'test';<br>$pass = sha1('test'); // Line 5<br>$prepared = $db-&gt;prepare("SELECT id FROM users WHERE user = ? AND pass = ? LIMIT 1");<br>$prepared-&gt;bind_param('ss', $user, $pass);<br>$prepared-&gt;execute();<br>$prepared-&gt;bind_result($id);<br>$prepared-&gt;fetch(); // $id now becomes 2. // Line 10<br>$prepared2 = $db-&gt;prepare("SELECT id, name, quote FROM metals");<br>$prepared2-&gt;execute();<br><br>?&gt;<br></pre></div><br><br>Error:<br><div>code:<pre><br>Warning: mysqli::prepare() [function.mysqli-prepare]: All data must be fetched before a new statement prepare takes place in C:\...\test5.php on line 11<br><br>Fatal error: Call to a member function execute() on a non-object in C:\...\test5.php on line 12<br></pre></div><br><br>Calling $prepared-&gt;close() after $prepared-&gt;fetch() prevents the error, but the thing is that as you can see from the "LIMIT 1" in the query, there is only 1 row of data to be fetched. So after the fetch() statement, I don't understand why should there be an error when the script tries to prepare another statement?<br><br>Here's something even weirder - if I call another fetch() statement after the first one, the error disappears as well. And through var_dump(), I found out that the first fetch() returns true and the second returns NULL - which means there is no data to be fetched already. And the value of $id doesn't change after the first fetch().<br><br><a href="http://sg.php.net/manual/en/function.mysqli-stmt-fetch.php" rel="nofollow">http://sg.php.net/manual/en/function.mysqli-stmt-fetch.php</a><br><br>Any idea what is actually going on behind all these issues?<br><br>PS: You guys wouldn't mind if I post this in other forums as well, right?  <img src="/images/emoticons/classic/icon_wink.gif" alt="Wink" title="Wink"><br></div>
          </div>
        </li>
        <li class='list-group-item'>
          <div id='div-gpt-ad-1528181032761-2' style='height:250px; width:300px;'><script>googletag.cmd.push(function(){googletag.display('div-gpt-ad-1528181032761-2');});</script></div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-11-22T12:15:58+00:00'>22 Nov 07, 12:15</time>
            </div>
            <div class='col-md body'>No idea, but I'm thinking if it's some sort of closing. If you open, you need to close. If you look at their sample codes, it executed the whole script, print the results and close it.<br><br>Posting at other forums help, not programming expert.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>GIB</div>
              <time class='date' datetime='2007-11-22T14:06:36+00:00'>22 Nov 07, 14:06</time>
            </div>
            <div class='col-md body'>From PHP website:<br><br>Be careful with fetch() when you use prepared statements and MySQL (I don`t know how it is with other databases). Fetch won`t close cursor and won`t let you send any other query, even if your result set has only one row, .<br>If you use $statement-&gt;fetch(), you will also have to use $statement-&gt;closeCursor() afterwards, to be able to execute another query.<br>Alternatively you can use $statement-&gt;fetchAll() without $statement-&gt;closeCursor().</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>eagle</div>
              <time class='date' datetime='2007-11-22T14:32:21+00:00'>22 Nov 07, 14:32</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by GIB:</div><div class="quote_body">From PHP website:<br><br>Be careful with fetch() when you use prepared statements and MySQL (I don`t know how it is with other databases). Fetch won`t close cursor and won`t let you send any other query, even if your result set has only one row, .<br>If you use $statement-&gt;fetch(), you will also have to use $statement-&gt;closeCursor() afterwards, to be able to execute another query.<br>Alternatively you can use $statement-&gt;fetchAll() without $statement-&gt;closeCursor(). </div></blockquote>first time see u didn't post in jokes forum</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>GIB</div>
              <time class='date' datetime='2007-11-22T14:43:00+00:00'>22 Nov 07, 14:43</time>
            </div>
            <div class='col-md body'>Occasionally, I drop in on other forums here and there to donate my 2cents.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>LatecomerX</div>
              <time class='date' datetime='2007-11-22T16:43:50+00:00'>22 Nov 07, 16:43</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by ndmmxiaomayi:</div><div class="quote_body">No idea, but I'm thinking if it's some sort of closing. If you open, you need to close. If you look at their sample codes, it executed the whole script, print the results and close it.<br><br>Posting at other forums help, not programming expert.</div></blockquote>If I run two fetch(), I can prepare another statement without closing the first. But this is semantically wrong since I don't intend to run fetch() twice when there's only one row of data to extract.<br></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>LatecomerX</div>
              <time class='date' datetime='2007-11-22T16:51:20+00:00'>22 Nov 07, 16:51</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by GIB:</div><div class="quote_body">From PHP website:<br><br>Be careful with fetch() when you use prepared statements and MySQL (I don`t know how it is with other databases). Fetch won`t close cursor and won`t let you send any other query, even if your result set has only one row, .<br>If you use $statement-&gt;fetch(), you will also have to use $statement-&gt;closeCursor() afterwards, to be able to execute another query.<br>Alternatively you can use $statement-&gt;fetchAll() without $statement-&gt;closeCursor(). </div></blockquote>As mentioned above, running a second, redundant fetch() removes the need to close the statement, which is baffling me a lot. And I don't see a fetchAll() function in the manual for MySQLi objects, but I suppose the same functionality can be achieved with a fetch() + while loop. Anyway, the script will only be fetching one data row, so no need for teh loopie.<br></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>and rew</div>
              <time class='date' datetime='2007-11-22T16:52:11+00:00'>22 Nov 07, 16:52</time>
            </div>
            <div class='col-md body'>Deleted.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>LatecomerX</div>
              <time class='date' datetime='2007-11-22T16:53:50+00:00'>22 Nov 07, 16:53</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by GIB:</div><div class="quote_body">Occasionally, I drop in on other forums here and there to donate my 2cents.</div></blockquote>I also occasionally drop by your Jokes and Humour forum and donate my 2  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  to your jokes. Keep them coming.  <img src="/images/emoticons/classic/icon_wink.gif" alt="Wink" title="Wink"><br></div>
          </div>
        </li>
      </ul>
      <nav class='pagination'>
      </nav>
      <footer>
        <nav class='nav'>
          <a class='nav-link' href='/'>Home</a>
          <a class='nav-link' href='/privacy/'>Privacy</a>
          <a class='nav-link' href='/terms/'>Terms</a>
        </nav>
      </footer>
    </div>
    <div id='div-gpt-ad-1528181032761-0' style='height:1px; width:1px;'><script>googletag.cmd.push(function(){googletag.display('div-gpt-ad-1528181032761-0');});</script></div>
  </body>
</html>

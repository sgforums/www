<!DOCTYPE html>
<html lang='en'>
  <head>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PK63DK');</script>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <meta charset='utf-8'>
    <meta content='width=device-width, initial-scale=1, shrink-to-fit=no' name='viewport'>
    <link crossorigin='anonymous' href='https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css' integrity='sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB' rel='stylesheet'>
    <link href='/styles.css' rel='stylesheet'>
    <title>source code</title>
    <script async='async' src='https://www.googletagservices.com/tag/js/gpt.js'></script><script>var googletag=googletag ||{}; googletag.cmd=googletag.cmd || [];</script><script>googletag.cmd.push(function(){googletag.defineSlot('\/1010898\/sgforums_interstitial', [ 1.0 , 1.0], 'div-gpt-ad-1528181032761-0').setTargeting('forum', ['2250']).setTargeting('topic', ['243020']).addService(googletag.pubads()); googletag.defineSlot('\/1010898\/sgforums_leaderboard', [[ 728.0 , 90.0], [ 970.0 , 250.0]], 'div-gpt-ad-1528181032761-1').setTargeting('forum', ['2250']).setTargeting('topic', ['243020']).addService(googletag.pubads()); googletag.defineSlot('\/1010898\/sgforums_mpu', [ 300.0 , 250.0], 'div-gpt-ad-1528181032761-2').setTargeting('forum', ['2250']).setTargeting('topic', ['243020']).addService(googletag.pubads()); googletag.defineSlot('\/1010898\/sgforums_supersky', [ 160.0 , 600.0], 'div-gpt-ad-1528181032761-3').setTargeting('forum', ['2250']).setTargeting('topic', ['243020']).addService(googletag.pubads()); googletag.pubads().enableSingleRequest(); googletag.enableServices();});</script>
  </head>
  <body>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PK63DK"height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <div class='container'>
      <a href='/'>Home</a>
      >
      <a href='/forums/2250/'>IT Support and Tech Corner</a>
      <h1>source code</h1>
      <nav class='pagination'>
        <a class='page-link' href='/forums/2250/topics/243020/2/'>Next</a>
      </nav>
      <ul class='list-group posts'>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T09:35:05+00:00'>17 Mar 07, 09:35</time>
            </div>
            <div class='col-md body'>Lets say i have 2 programs, i nid to edit<br>1 of the source code to make it fix intto another program<br>how do i do it? <img src="/images/emoticons/classic/icon_eek.gif" alt="Shocked" title="Shocked"><br>teach mi can? in full details..  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"><br>or help mi?  <img src="/images/emoticons/classic/icon_razz.gif" alt="Razz" title="Razz">  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"></div>
          </div>
        </li>
        <li class='list-group-item'>
          <div id='div-gpt-ad-1528181032761-2' style='height:250px; width:300px;'><script>googletag.cmd.push(function(){googletag.display('div-gpt-ad-1528181032761-2');});</script></div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>thoreldan</div>
              <time class='date' datetime='2007-03-17T13:20:53+00:00'>17 Mar 07, 13:20</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">Lets say i have 2 programs, i nid to edit<br>1 of the source code to make it fix intto another program<br>how do i do it? <img src="/images/emoticons/classic/icon_eek.gif" alt="Shocked" title="Shocked"><br>teach mi can? in full details..  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"><br>or help mi?  <img src="/images/emoticons/classic/icon_razz.gif" alt="Razz" title="Razz">  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"> </div></blockquote>what are you trying to say?<br><br>catch no ball  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"><br><br>what do you mean"edit 1 of the source code to make it fix intto another program?"</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>surferpunk</div>
              <time class='date' datetime='2007-03-17T13:32:33+00:00'>17 Mar 07, 13:32</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">Lets say i have 2 programs, i nid to edit<br>1 of the source code to make it fix intto another program<br>how do i do it? <img src="/images/emoticons/classic/icon_eek.gif" alt="Shocked" title="Shocked"><br>teach mi can? in full details..  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"><br>or help mi?  <img src="/images/emoticons/classic/icon_razz.gif" alt="Razz" title="Razz">  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"> </div></blockquote>Ermmm... just copy and paste?? lol... and just make sure u change the necessary names of the variables to ensure the program to run. does that answer your question? lol...</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>Darkness_hacker99</div>
              <time class='date' datetime='2007-03-17T13:38:15+00:00'>17 Mar 07, 13:38</time>
            </div>
            <div class='col-md body'>You want to put password in your blog ar?  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>OasisBlue</div>
              <time class='date' datetime='2007-03-17T14:11:18+00:00'>17 Mar 07, 14:11</time>
            </div>
            <div class='col-md body'>sry to hijack the thread just wanna ask how do you encrypt your source code?</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T19:45:11+00:00'>17 Mar 07, 19:45</time>
            </div>
            <div class='col-md body'>ok, guess i jzu let the story out, its like this,<br>a AC that i used frequently use in a game called Maplestory<br>cant be used anymore, now, i gt a package called  a Source<br>Code to make it work in the game, wad i wan to ask is,<br>how do i change it to enable the AC to be able to use<br>in the game?  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T20:14:41+00:00'>17 Mar 07, 20:14</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">ok, guess i jzu let the story out, its like this,<br>a AC that i used frequently use in a game called Maplestory<br>cant be used anymore, now, i gt a package called  a Source<br>Code to make it work in the game, wad i wan to ask is,<br>how do i change it to enable the AC to be able to use<br>in the game?  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"> </div></blockquote>can sum1 tell mi, or do it 4 mi  <img src="/images/emoticons/classic/icon_razz.gif" alt="Razz" title="Razz"><br>help would be veri appreciated...  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"><br>pros helppp!!!!  <img src="/images/emoticons/classic/icon_redface.gif" alt="Embarassed" title="Embarassed">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>Y_Shun</div>
              <time class='date' datetime='2007-03-17T20:26:38+00:00'>17 Mar 07, 20:26</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by OasisBlue:</div><div class="quote_body">sry to hijack the thread just wanna ask how do you encrypt your source code?</div></blockquote><a href="http://www.dynamicdrive.com/dynamicindex9/encrypter.htm" rel="nofollow">http://www.dynamicdrive.com/dynamicindex9/encrypter.htm</a><br><br>there are also HTML Protector softwares that oso encrypts these HTML until WEIRD symbols that you cannot even figure out whats the original.<br><br>the one above actually can de-encrypt back to see your code one.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-17T20:53:44+00:00'>17 Mar 07, 20:53</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by OasisBlue:</div><div class="quote_body">sry to hijack the thread just wanna ask how do you encrypt your source code?</div></blockquote>Programming codes - use a packer. Common ones used are UPX.<br><br>HTML codes - No idea why you want to encrypt, it's unreadable to a browser.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-17T20:55:30+00:00'>17 Mar 07, 20:55</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">ok, guess i jzu let the story out, its like this,<br>a AC that i used frequently use in a game called Maplestory<br>cant be used anymore, now, i gt a package called  a Source<br>Code to make it work in the game, wad i wan to ask is,<br>how do i change it to enable the AC to be able to use<br>in the game?  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"> </div></blockquote>You need a compiler.<br><br>Show us the source codes. There are so many types of programming languages out there, don't expect me to figure out what programming language that the programmer used. I can't tell just by looking at the program.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>OasisBlue</div>
              <time class='date' datetime='2007-03-17T21:26:57+00:00'>17 Mar 07, 21:26</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by Y_Shun:</div><div class="quote_body"><a href="http://www.dynamicdrive.com/dynamicindex9/encrypter.htm" rel="nofollow">http://www.dynamicdrive.com/dynamicindex9/encrypter.htm</a><br><br>there are also HTML Protector softwares that oso encrypts these HTML until WEIRD symbols that you cannot even figure out whats the original.<br><br>the one above actually can de-encrypt back to see your code one.</div></blockquote>thanks! <img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:20:04+00:00'>17 Mar 07, 23:20</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by ndmmxiaomayi:</div><div class="quote_body">You need a compiler.<br><br>Show us the source codes. There are so many types of programming languages out there, don't expect me to figure out what programming language that the programmer used. I can't tell just by looking at the program.</div></blockquote>sure<br><span style="color: olive;">clsregistry.cls</span>VERSION 1.0 CLASS<br>BEGIN<br>MultiUse = -1  'True<br>Persistable = 0  'NotPersistable<br>DataBindingBehavior = 0  'vbNone<br>DataSourceBehavior  = 0  'vbNone<br>MTSTransactionMode  = 0  'NotAnMTSObject<br>END<br>Attribute VB_Name = "Registry"<br>Attribute VB_GlobalNameSpace = False<br>Attribute VB_Creatable = True<br>Attribute VB_PredeclaredId = False<br>Attribute VB_Exposed = False<br>Option Explicit<br><br>'Registry Events<br>Public Event RegistryError(ByVal Number As Long, ByVal Description As String)<br><br>'Registry API declarations<br>Private Declare Function RegFlushKey Lib "advapi32.dll" (ByVal hKey As Long) As Long<br>Private Declare Function RegCloseKey Lib "advapi32.dll" (ByVal hKey As Long) As Long<br>Private Declare Function RegOpenKey Lib "advapi32.dll" Alias "RegOpenKeyA" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long<br>Private Declare Function RegQueryValueEx Lib "advapi32.dll" Alias "RegQueryValueExA" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long<br>Private Declare Function RegSetValueEx Lib "advapi32.dll" Alias "RegSetValueExA" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, lpData As Any, ByVal cbData As Long) As Long<br>Private Declare Function RegCreateKey Lib "advapi32.dll" Alias "RegCreateKeyA" (ByVal hKey As Long, ByVal lpSubKey As String, phkResult As Long) As Long<br>Private Declare Function RegDeleteKey Lib "advapi32.dll" Alias "RegDeleteKeyA" (ByVal hKey As Long, ByVal lpSubKey As String) As Long<br><br>'Kernel32 declaration<br>Private Declare Function FormatMessage Lib "Kernel32" Alias "FormatMessageA" (ByVal dwFlags As Long, lpSource As Any, ByVal dwMessageId As Long, ByVal dwLanguageId As Long, ByVal lpBuffer As String, ByVal nSize As Long, Arguments As Long) As Long<br>Private Declare Function GetVersionEx Lib "Kernel32" Alias "GetVersionExA" (lpVersionInformation As OSVERSIONINFO) As Long<br><br>Private Type OSVERSIONINFO<br>dwOSVersionInfoSize As Long<br>dwMajorVersion As Long<br>dwMinorVersion As Long<br>dwBuildNumber As Long<br>dwPlatformId As Long<br>szCSDVersion As String * 128      '  Maintenance string for PSS usage<br>End Type<br><br>'Operating System Platform ID constants<br>Private Const VER_PLATFORM_WIN32_NT = 2<br><br>'FormatMessage constants<br>Private Const FORMAT_MESSAGE_FROM_SYSTEM = &amp;H1000<br><br>'Registry Root Key constants<br>Public Enum RegRootKey<br>HKEY_CLASSES_ROOT = &amp;H80000000<br>HKEY_CURRENT_CONFIG = &amp;H80000005<br>HKEY_CURRENT_USER = &amp;H80000001<br>HKEY_DYN_DATA = &amp;H80000006<br>HKEY_LOCAL_MACHINE = &amp;H80000002<br>HKEY_USERS = &amp;H80000003<br>End Enum<br><br>'Registry Data Type constants<br>Public Enum RegDataType<br>REG_SZ = 1<br>REG_BINARY = 3<br>REG_DWORD = 4<br>REG_DWORD_BIG_ENDIAN = 5<br>REG_DWORD_LITTLE_ENDIAN = 4<br>REG_QWORD = 11<br>REG_QWORD_LITTLE_ENDIAN = 11<br>REG_EXPAND_SZ = 2<br>REG_MULTI_SZ = 7<br>REG_NONE = 0<br>End Enum<br><br>'Registry base error code<br>Private Const ERROR_BASE = 50000<br><br>'Windows Error Code constants<br>Public Enum RegErrorCode<br>ERROR_SUCCESS = 0&amp;<br>ERROR_MORE_DATA = ERROR_BASE + 234<br>ERROR_INVALID_FUNCTION = ERROR_BASE + 1<br>ERROR_FILE_NOT_FOUND = ERROR_BASE + 2&amp;<br>ERROR_ACCESS_DENIED = ERROR_BASE + 5&amp;<br>ERROR_INVALID_HANDLE = ERROR_BASE + 6&amp;<br>ERROR_INVALID_ACCESS = ERROR_BASE + 12&amp;<br>ERROR_OUTOFMEMORY = ERROR_BASE + 14&amp;<br>ERROR_NETNAME_DELETED = ERROR_BASE + 64&amp;<br>ERROR_NETWORK_ACCESS_DENIED = ERROR_BASE + 65&amp;<br>ERROR_TOO_MANY_SESS = ERROR_BASE + 69&amp;<br>ERROR_INVALID_PARAMETER = ERROR_BASE + 87<br>ERROR_BAD_PATHNAME = ERROR_BASE + 161&amp;<br>End Enum<br><br>'Property variables<br>Private pSubKey      As String<br>Private pRootKey     As RegRootKey<br>Private pDataType    As RegDataType<br>Private pValueName   As String<br>Private pForceWrite  As Boolean<br>Private pReportError As Boolean<br><br>Private Function IsWindowsNT() As Boolean<br>Dim lpOSVerInfo As OSVERSIONINFO<br><br>'Initialize the structure<br>lpOSVerInfo.dwOSVersionInfoSize = Len(lpOSVerInfo)<br><br>'Check Windows Platform ID<br>GetVersionEx lpOSVerInfo<br><br>If lpOSVerInfo.dwPlatformId = VER_PLATFORM_WIN32_NT Then<br>'This is Windows NT<br>IsWindowsNT = True<br>End If<br><br>End Function<br><br>Private Sub RaiseError(ByVal Number As Long)<br>Dim Desc    As String * 255<br>Dim nChar   As Long<br><br>If Err.Number &lt;&gt; 0 Then<br>'Replace with local error if no error occurred in API<br>Number = Err.Number<br>Desc = Err.Description<br>Else<br>'Format the error code into description<br>nChar = FormatMessage(FORMAT_MESSAGE_FROM_SYSTEM, ByVal 0&amp;, Number, 0, Desc, 255, ByVal 0&amp;)<br><br>Desc = Left(Desc, nChar)<br>End If<br><br>If ReportError Then<br>'Raise error<br>Err.Raise Number, "Registry", Desc<br>End If<br><br>RaiseEvent RegistryError(Number, Desc)<br><br>End Sub<br><br>Public Property Get ReportError() As Boolean<br>ReportError = pReportError<br>End Property<br><br>Public Property Let ReportError(ByVal Value As Boolean)<br>pReportError = Value<br>End Property<br><br>Public Property Get ForceWrite() As Boolean<br>ForceWrite = pForceWrite<br>End Property<br><br>Public Property Let ForceWrite(ByVal Value As Boolean)<br>pForceWrite = Value<br>End Property<br><br>Public Property Get RootKey() As RegRootKey<br>RootKey = pRootKey<br>End Property<br><br>Public Property Let RootKey(ByVal Value As RegRootKey)<br>pRootKey = Value<br>End Property<br><br>Public Property Get SubKey() As String<br>SubKey = pSubKey<br>End Property<br><br>Public Property Let SubKey(ByVal Value As String)<br>pSubKey = Value<br>End Property<br><br>Public Property Get ValueName() As String<br>ValueName = pValueName<br>End Property<br><br>Public Property Let ValueName(ByVal Value As String)<br>pValueName = Value<br>End Property<br><br>Public Property Get DataType() As RegDataType<br>DataType = pDataType<br>End Property<br><br>Public Property Let DataType(ByVal Value As RegDataType)<br>pDataType = Value<br>End Property<br><br>Public Property Get Data() As Variant<br>Dim lpBufferCurrency    As Currency<br>Dim lpBufferBinary()    As Byte<br>Dim lpBufferString      As String<br>Dim lpBufferLong        As Long<br>Dim nSize               As Long<br>Dim hKey                As Long<br>Dim lRet                As Long<br><br>On Local Error GoTo Finally<br><br>'Open a handle to the required registry key<br>lRet = RegOpenKey(pRootKey, pSubKey, hKey)<br><br>If lRet = ERROR_SUCCESS Then<br>'Retrieve the data type and data size<br>RegQueryValueEx hKey, pValueName, 0&amp;, pDataType, ByVal 0&amp;, nSize<br><br>'Convert the buffer to the data type we wanted<br>Select Case pDataType<br>Case REG_BINARY 'Binary data<br>'Initialize buffer to retrieve data<br>ReDim lpBufferBinary(1 To nSize)<br><br>'Retrieve the binary data<br>lRet = RegQueryValueEx(hKey, pValueName, 0&amp;, pDataType, lpBufferBinary(1), nSize)<br><br>If lRet = ERROR_SUCCESS Then<br>'Return the value<br>Data = lpBufferBinary<br>End If<br>Case REG_SZ, REG_EXPAND_SZ, REG_MULTI_SZ 'String<br>'Initialize buffer to retrieve string data<br>lpBufferString = Space(nSize)<br><br>'Retrieve the string data<br>lRet = RegQueryValueEx(hKey, pValueName, 0&amp;, pDataType, ByVal lpBufferString, nSize)<br><br>If lRet = ERROR_SUCCESS Then<br>'Return the data<br>Data = Left(lpBufferString, nSize - 1)<br>End If<br>Case REG_DWORD, REG_DWORD_BIG_ENDIAN 'Long/Int32<br>'Retrieve the DWord value<br>lRet = RegQueryValueEx(hKey, pValueName, 0&amp;, pDataType, lpBufferLong, nSize)<br><br>If lRet = ERROR_SUCCESS Then<br>'Return the value<br>Data = lpBufferLong<br>End If<br>Case REG_QWORD 'Currency/Int64<br>'Retrieve the QWord value<br>lRet = RegQueryValueEx(hKey, pValueName, 0&amp;, pDataType, lpBufferCurrency, nSize)<br><br>If lRet = ERROR_SUCCESS Then<br>'Return the value<br>Data = lpBufferCurrency<br>End If<br>End Select<br>End If<br><br>Finally:<br>'Reset error information<br>RaiseError lRet<br><br>'Release handle<br>RegCloseKey hKey<br><br>End Property<br><br>Public Property Let Data(ByVal Value As Variant)<br>Dim hKey As Long<br>Dim lRet As Long<br><br>'Open a handle to the required key<br>lRet = RegCreateKey(pRootKey, pSubKey, hKey)<br>If lRet &lt;&gt; ERROR_SUCCESS Then RaiseError lRet<br><br>'Automatically determine the data type<br>Select Case VarType(Value)<br>Case vbByte, vbInteger, vbLong, vbBoolean<br>'DWord value<br>pDataType = REG_DWORD<br>lRet = RegSetValueEx(hKey, pValueName, 0&amp;, pDataType, ByVal VarPtr(CLng(Value)), 4)<br>Case vbString<br>'LPStr value<br>pDataType = REG_SZ<br><br>If IsWindowsNT() Then<br>lRet = RegSetValueEx(hKey, pValueName, 0&amp;, pDataType, ByVal StrPtr(StrConv(Value, vbFromUnicode)), Len(Value))<br>Else<br>lRet = RegSetValueEx(hKey, pValueName, 0&amp;, pDataType, ByVal StrPtr(StrConv(Value, vbFromUnicode)), (Len(Value) \ 2))<br>End If<br><br>Case vbCurrency<br>'QWord value<br>pDataType = REG_QWORD<br>lRet = RegSetValueEx(hKey, pValueName, 0&amp;, pDataType, ByVal VarPtr(CCur(Value)), <img src="/images/emoticons/classic/icon_cool.gif" alt="Cool" title="Cool"><br>Case Else<br>'Unreconised data type<br>GoTo Finally<br>End Select<br><br>'Set the value of the key<br>If lRet &lt;&gt; ERROR_SUCCESS Then RaiseError lRet<br><br>If pForceWrite Then<br>'Force the operation system to write the changes<br>RegFlushKey hKey<br>End If<br><br>Finally:<br>'Close the handle<br>RegCloseKey hKey<br><br>End Property<br><br>Public Function GetData(Optional RootKey, Optional SubKey, Optional ValueName) As Variant<br>'Set optional property<br>If Not IsMissing(SubKey) Then Me.SubKey = SubKey<br>If Not IsMissing(RootKey) Then Me.RootKey = RootKey<br>If Not IsMissing(ValueName) Then Me.ValueName = ValueName<br><br>'Retrieve data<br>GetData = Me.Data<br>End Function<br><br>Public Sub SetData(ByVal Data, Optional RootKey, Optional SubKey, Optional ValueName)<br>'Set optional property<br>If Not IsMissing(SubKey) Then Me.SubKey = SubKey<br>If Not IsMissing(RootKey) Then Me.RootKey = RootKey<br>If Not IsMissing(ValueName) Then Me.ValueName = ValueName<br><br>'Set data<br>Me.Data = Data<br>End Sub<br><br><span style="color: green;">frm.Mspro.frm</span>VERSION 5.00<br>Begin VB.Form frmMSPro<br>BorderStyle     =   3  'Fixed Dialog<br>Caption         =   "MSPro v3"<br>ClientHeight    =   6765<br>ClientLeft      =   45<br>ClientTop       =   435<br>ClientWidth     =   6360<br>LinkTopic       =   "Form1"<br>LockControls    =   -1  'True<br>MaxButton       =   0   'False<br>MinButton       =   0   'False<br>ScaleHeight     =   6765<br>ScaleWidth      =   6360<br>Begin VB.Timer tmrWindowedMode<br>Enabled         =   0   'False<br>Interval        =   1000<br>Left            =   1080<br>Top             =   6240<br>End<br>Begin VB.CheckBox chkFocusCheck<br>Alignment       =   1  'Right Justify<br>Caption         =   "Focus Check :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Left            =   640<br>TabIndex        =   29<br>ToolTipText     =   "Specifies whether to pause all the macro when MapleStory is out of focus"<br>Top             =   5160<br>Width           =   1990<br>End<br>Begin VB.Timer tmrAutoHide<br>Interval        =   1<br>Left            =   600<br>Top             =   6240<br>End<br>Begin VB.CommandButton cmdClose<br>Caption         =   "Close"<br>Height          =   495<br>Left            =   3413<br>TabIndex        =   15<br>Top             =   5760<br>Width           =   1215<br>End<br>Begin VB.CommandButton cmdSave<br>Caption         =   "Save"<br>Height          =   495<br>Left            =   1733<br>TabIndex        =   14<br>Top             =   5760<br>Width           =   1215<br>End<br>Begin VB.ComboBox cboAutoClicker<br>Height          =   315<br>Left            =   2430<br>Style           =   2  'Dropdown List<br>TabIndex        =   0<br>ToolTipText     =   "Assigns the hotkey to toggle auto-clicker"<br>Top             =   840<br>Width           =   1455<br>End<br>Begin VB.ComboBox cboAutoPotionHP<br>Height          =   315<br>Left            =   2430<br>Style           =   2  'Dropdown List<br>TabIndex        =   4<br>ToolTipText     =   "Assigns the hotkey to toggle HP auto-potion"<br>Top             =   2280<br>Width           =   1455<br>End<br>Begin VB.ComboBox cboAutoChat<br>Height          =   315<br>Left            =   2430<br>Style           =   2  'Dropdown List<br>TabIndex        =   1<br>ToolTipText     =   "Assigns the hotkey to toggle auto-chat"<br>Top             =   1320<br>Width           =   1455<br>End<br>Begin VB.ComboBox cboAutoLootKey<br>Height          =   315<br>Left            =   4575<br>Style           =   2  'Dropdown List<br>TabIndex        =   3<br>ToolTipText     =   "Assigns which pickup key to press when auto-loot is on"<br>Top             =   1800<br>Width           =   1455<br>End<br>Begin VB.ComboBox cboAutoLoot<br>Height          =   315<br>Left            =   2430<br>Style           =   2  'Dropdown List<br>TabIndex        =   2<br>ToolTipText     =   "Assigns the hotkey to toggle auto-loot"<br>Top             =   1800<br>Width           =   1455<br>End<br>Begin VB.ComboBox cboHPPotion<br>Height          =   315<br>Left            =   4575<br>Style           =   2  'Dropdown List<br>TabIndex        =   5<br>ToolTipText     =   "Assigns which HP potion key to press when HP is low"<br>Top             =   2280<br>Width           =   1455<br>End<br>Begin VB.CheckBox chkBeepNotify<br>Alignment       =   1  'Right Justify<br>Caption         =   "Beep Notify :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Left            =   810<br>TabIndex        =   12<br>ToolTipText     =   "Specifies whether to beep when a hotkey is triggered"<br>Top             =   4200<br>Width           =   1815<br>End<br>Begin VB.ComboBox cboMPPotion<br>Height          =   315<br>Left            =   4590<br>Style           =   2  'Dropdown List<br>TabIndex        =   9<br>ToolTipText     =   "Assigns which MP potion key to press when MP is low"<br>Top             =   3240<br>Width           =   1455<br>End<br>Begin VB.ComboBox cboAutoPotionMP<br>Height          =   315<br>Left            =   2445<br>Style           =   2  'Dropdown List<br>TabIndex        =   8<br>ToolTipText     =   "Assigns the hotkey to toggle MP auto-potion"<br>Top             =   3240<br>Width           =   1455<br>End<br>Begin VB.HScrollBar hscHPAlarm<br>Height          =   255<br>Left            =   2415<br>Max             =   100<br>Min             =   1<br>TabIndex        =   6<br>Top             =   2760<br>Value           =   30<br>Width           =   3015<br>End<br>Begin VB.TextBox txtHPAlarm<br>Height          =   285<br>Left            =   5535<br>Locked          =   -1  'True<br>TabIndex        =   7<br>Text            =   "txtHPAlarm"<br>ToolTipText     =   "Specifies the HP level to trigger auto-potion"<br>Top             =   2760<br>Width           =   495<br>End<br>Begin VB.TextBox txtMPAlarm<br>Height          =   285<br>Left            =   5550<br>Locked          =   -1  'True<br>TabIndex        =   11<br>Text            =   "txtMPAlarm"<br>ToolTipText     =   "Specifies the MP level to trigger auto-potion"<br>Top             =   3720<br>Width           =   495<br>End<br>Begin VB.HScrollBar hscMPAlarm<br>Height          =   255<br>Left            =   2430<br>Max             =   100<br>Min             =   1<br>TabIndex        =   10<br>Top             =   3720<br>Value           =   30<br>Width           =   3015<br>End<br>Begin VB.CheckBox chkWindowedMode<br>Alignment       =   1  'Right Justify<br>Caption         =   "Windowed Mode :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Left            =   270<br>TabIndex        =   13<br>ToolTipText     =   "Specifies whether to run MapleStory in windowed mode"<br>Top             =   4680<br>Width           =   2360<br>End<br>Begin VB.Timer tmrState<br>Interval        =   1<br>Left            =   120<br>Top             =   6240<br>End<br>Begin VB.Line Line1<br>X1              =   120<br>X2              =   6240<br>Y1              =   600<br>Y2              =   600<br>End<br>Begin VB.Label lblSignature<br>Alignment       =   1  'Right Justify<br>AutoSize        =   -1  'True<br>Caption         =   "lblSignature"<br>Height          =   195<br>Left            =   5400<br>TabIndex        =   28<br>Top             =   6480<br>Width           =   825<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "Auto-Clicker:"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   0<br>Left            =   840<br>TabIndex        =   27<br>Top             =   840<br>Width           =   1350<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "HP Auto-Potion:"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   4<br>Left            =   480<br>TabIndex        =   26<br>Top             =   2280<br>Width           =   1710<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "Auto-Chat :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   1<br>Left            =   975<br>TabIndex        =   25<br>Top             =   1320<br>Width           =   1215<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "Auto-Loot :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   2<br>Left            =   1005<br>TabIndex        =   24<br>Top             =   1800<br>Width           =   1185<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "Key :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   3<br>Left            =   4095<br>TabIndex        =   23<br>Top             =   1800<br>Width           =   510<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "Key :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   5<br>Left            =   4095<br>TabIndex        =   22<br>Top             =   2280<br>Width           =   510<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "Key :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   8<br>Left            =   4110<br>TabIndex        =   21<br>Top             =   3240<br>Width           =   510<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "MP Auto-Potion:"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   7<br>Left            =   480<br>TabIndex        =   20<br>Top             =   3240<br>Width           =   1725<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "HP Alarm :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   6<br>Left            =   1080<br>TabIndex        =   19<br>Top             =   2760<br>Width           =   1125<br>End<br>Begin VB.Label Label<br>Alignment       =   1  'Right Justify<br>Caption         =   "MP Alarm :"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Index           =   9<br>Left            =   1080<br>TabIndex        =   18<br>Top             =   3720<br>Width           =   1140<br>End<br>Begin VB.Label lblHook<br>Alignment       =   1  'Right Justify<br>Caption         =   "MSPro Status:"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   400<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Left            =   240<br>TabIndex        =   17<br>Top             =   120<br>Width           =   1545<br>End<br>Begin VB.Label lblState<br>Alignment       =   2  'Center<br>Caption         =   "lblState"<br>BeginProperty Font<br>Name            =   "MS Sans Serif"<br>Size            =   12<br>Charset         =   0<br>Weight          =   700<br>Underline       =   0   'False<br>Italic          =   0   'False<br>Strikethrough   =   0   'False<br>EndProperty<br>Height          =   300<br>Left            =   1920<br>TabIndex        =   16<br>Top             =   120<br>Width           =   4245<br>End<br>End<br>Attribute VB_Name = "frmMSPro"<br>Attribute VB_GlobalNameSpace = False<br>Attribute VB_Creatable = False<br>Attribute VB_PredeclaredId = True<br>Attribute VB_Exposed = False<br>Option Explicit<br><br>'DirectInput ScanCode Constants<br>Private Const DIK_ESCAPE = 1<br>Private Const DIK_1 = 2<br>Private Const DIK_2 = 3<br>Private Const DIK_3 = 4<br>Private Const DIK_4 = 5<br>Private Const DIK_5 = 6<br>Private Const DIK_6 = 7<br>Private Const DIK_7 = 8<br>Private Const DIK_8 = 9<br>Private Const DIK_9 = 10<br>Private Const DIK_0 = 11<br>Private Const DIK_MINUS = 12<br>Private Const DIK_EQUALS = 13<br>Private Const DIK_BACKSPACE = 14<br>Private Const DIK_TAB = 15<br>Private Const DIK_Q = 16<br>Private Const DIK_W = 17<br>Private Const DIK_E = 18<br>Private Const DIK_R = 19<br>Private Const DIK_T = 20<br>Private Const DIK_Y = 21<br>Private Const DIK_U = 22<br>Private Const DIK_I = 23<br>Private Const DIK_O = 24<br>Private Const DIK_P = 25<br>Private Const DIK_LBRACKET = 26<br>Private Const DIK_RBRACKET = 27<br>Private Const DIK_RETURN = 28<br>Private Const DIK_LCONTROL = 29<br>Private Const DIK_A = 30<br>Private Const DIK_S = 31<br>Private Const DIK_D = 32<br>Private Const DIK_F = 33<br>Private Const DIK_G = 34<br>Private Const DIK_H = 35<br>Private Const DIK_J = 36<br>Private Const DIK_K = 37<br>Private Const DIK_L = 38<br>Private Const DIK_SEMICOLON = 39<br>Private Const DIK_APOSTROPHE = 40<br>Private Const DIK_GRAVE = 41<br>Private Const DIK_LSHIFT = 42<br>Private Const DIK_BACKSLASH = 43<br>Private Const DIK_Z = 44<br>Private Const DIK_X = 45<br>Private Const DIK_C = 46<br>Private Const DIK_V = 47<br>Private Const DIK_B = 48<br>Private Const DIK_N = 49<br>Private Const DIK_M = 50<br>Private Const DIK_COMMA = 51<br>Private Const DIK_PERIOD = 52<br>Private Const DIK_SLASH = 53<br>Private Const DIK_RSHIFT = 54<br>Private Const DIK_MULTIPLY = 55<br>Private Const DIK_LALT = 56<br>Private Const DIK_SPACE = 57<br>Private Const DIK_CAPSLOCK = 58<br>Private Const DIK_F1 = 59<br>Private Const DIK_F2 = 60<br>Private Const DIK_F3 = 61<br>Private Const DIK_F4 = 62<br>Private Const DIK_F5 = 63<br>Private Const DIK_F6 = 64<br>Private Const DIK_F7 = 65<br>Private Const DIK_F8 = 66<br>Private Const DIK_F9 = 67<br>Private Const DIK_F10 = 68<br>Private Const DIK_NUMLOCK = 69<br>Private Const DIK_SCROLL = 70<br>Private Const DIK_NUMPAD7 = 71<br>Private Const DIK_NUMPAD8 = 72<br>Private Const DIK_NUMPAD9 = 73<br>Private Const DIK_SUBTRACT = 74<br>Private Const DIK_NUMPAD4 = 75<br>Private Const DIK_NUMPAD5 = 76<br>Private Const DIK_NUMPAD6 = 77<br>Private Const DIK_ADD = 78<br>Private Const DIK_NUMPAD1 = 79<br>Private Const DIK_NUMPAD2 = 80<br>Private Const DIK_NUMPAD3 = 81<br>Private Const DIK_NUMPAD0 = 82<br>Private Const DIK_DECIMAL = 83<br>Private Const DIK_F11 = 87<br>Private Const DIK_F12 = 88<br>Private Const DIK_NUMPADENTER = 156<br>Private Const DIK_RCONTROL = 157<br>Private Const DIK_DIVIDE = 181<br>Private Const DIK_RALT = 184<br>Private Const DIK_HOME = 199<br>Private Const DIK_UP = 200<br>Private Const DIK_PAGEUP = 201<br>Private Const DIK_LEFT = 203<br>Private Const DIK_RIGHT = 205<br>Private Const DIK_END = 207<br>Private Const DIK_DOWN = 208<br>Private Const DIK_PAGEDOWN = 209<br>Private Const DIK_INSERT = 210<br>Private Const DIK_DELETE = 211<br><br>'MSPro Functions<br>Private Declare Sub MSPro_Initialize Lib "MSPro_v3" ()<br>Private Declare Sub MSPro_Finalize Lib "MSPro_v3" ()<br>Private Declare Sub MSPro_SendKeystroke Lib "MSPro_v3" (ByVal bVk As Long)<br>Private Declare Function MSPro_GetState Lib "MSPro_v3" () As Long<br><br>Private Declare Sub MSPro_SetConfig1 Lib "MSPro_v3" (ByVal vKey As Long)<br>Private Declare Sub MSPro_SetConfig2 Lib "MSPro_v3" (ByVal vKey As Long)<br>Private Declare Sub MSPro_SetConfig3 Lib "MSPro_v3" (ByVal vKey As Long, ByVal vKey2 As Long)<br>Private Declare Sub MSPro_SetConfig4 Lib "MSPro_v3" (ByVal vKey As Long, ByVal vKey2 As Long, ByVal Alarm As Long)<br>Private Declare Sub MSPro_SetConfig5 Lib "MSPro_v3" (ByVal vKey As Long, ByVal vKey2 As Long, ByVal Alarm As Long)<br>Private Declare Sub MSPro_SetConfig6 Lib "MSPro_v3" (ByVal Enabled As Long)<br>Private Declare Sub MSPro_SetConfig7 Lib "MSPro_v3" (ByVal Enabled As Long)<br><br>'User32 Functions<br>Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long<br>Private Declare Function GetWindowRect Lib "user32" (ByVal hwnd As Long, lpRect As RECT) As Long<br>Private Declare Function GetForegroundWindow Lib "user32" () As Long<br><br>'Kernel32 Functions<br>Private Declare Function LoadLibrary Lib "Kernel32" Alias "LoadLibraryA" (ByVal lpLibFileName As String) As Long<br><br>Private Type POINTAPI<br>x As Long<br>y As Long<br>End Type<br><br>Private Type RECT<br>Left As Long<br>Top As Long<br>Right As Long<br>Bottom As Long<br>End Type<br><br>'MSPro State Constants<br>Private Const MSPRO_STATE_IDLE      As Long = 0<br>Private Const MSPRO_STATE_HOOK      As Long = 1<br>Private Const MSPRO_STATE_UNHOOK    As Long = 2<br>Private Const MSPRO_STATE_PIPEINIT  As Long = 3<br>Private Const MSPRO_STATE_PIPEOK    As Long = 4<br>Private Const MSPRO_STATE_PIPEERR   As Long = 5<br>Private Const MSPRO_STATE_GETFOCUS  As Long = 6<br>Private Const MSPRO_STATE_LOSTFOCUS As Long = 7<br><br>'Configurations<br>Private hkBeepNotify    As Boolean<br>Private hkWindowedMode  As Boolean<br>Private hkFocusCheck    As Boolean<br><br>Private hkAutoClicker   As Long<br>Private hkAutoPotionHP  As Long<br>Private hkHPPotion      As Long<br>Private hkHPAlarm       As Long<br>Private hkAutoPotionMP  As Long<br>Private hkMPPotion      As Long<br>Private hkMPAlarm       As Long<br>Private hkAutoChat      As Long<br>Private hkAutoLoot      As Long<br>Private hkAutoLootKey   As Long<br><br>Private StealthDll      As String<br><br>Private Function GetMaplePath() As String<br>Dim Registry As Registry<br><br>'Construct a new Registry API wrapper<br>Set Registry = New Registry<br><br>'Locate MapleStory path<br>GetMaplePath = Registry.GetData(HKEY_LOCAL_MACHINE, "Software\Wizet\MapleStory", "ExecPath")<br><br>'Destruct the Registry API wrapper<br>Set Registry = Nothing<br><br>End Function<br><br>Private Sub ShowForm(ByVal Show As Boolean)<br><br>If Show Then<br>'Show and enable the form<br>Me.Height = 7245<br>Else<br>'Hide the form<br>Me.Height = 1020<br>End If<br><br>End Sub<br><br>Private Sub SetHotkey()<br>'Configure MSPro hotkeys<br>MSPro_SetConfig1 hkAutoClicker<br>MSPro_SetConfig2 hkAutoChat<br>MSPro_SetConfig3 hkAutoLoot, hkAutoLootKey<br>MSPro_SetConfig4 hkAutoPotionHP, hkHPPotion, hkHPAlarm<br>MSPro_SetConfig5 hkAutoPotionMP, hkMPPotion, hkMPAlarm<br>MSPro_SetConfig6 hkBeepNotify<br>MSPro_SetConfig7 hkFocusCheck<br>End Sub<br><br>Private Sub ComboBox_FillVirtualKeys(ByVal ComboBox As ComboBox, Optional ByVal IsOptional As Boolean = True)<br>'Clear the combo box<br>ComboBox.Clear<br><br>If IsOptional Then<br>'Optional item<br>ComboBox_AddItemWithItemData ComboBox, "[NONE]", 0<br>End If<br><br>'Fill combo box with virtual keys<br>ComboBox_AddItemWithItemData ComboBox, "F1", vbKeyF1<br>ComboBox_AddItemWithItemData ComboBox, "F2", vbKeyF2<br>ComboBox_AddItemWithItemData ComboBox, "F3", vbKeyF3<br>ComboBox_AddItemWithItemData ComboBox, "F4", vbKeyF4<br>ComboBox_AddItemWithItemData ComboBox, "F5", vbKeyF5<br>ComboBox_AddItemWithItemData ComboBox, "F6", vbKeyF6<br>ComboBox_AddItemWithItemData ComboBox, "F7", vbKeyF7<br>ComboBox_AddItemWithItemData ComboBox, "F8", vbKeyF8<br>ComboBox_AddItemWithItemData ComboBox, "F9", vbKeyF9<br>ComboBox_AddItemWithItemData ComboBox, "F10", vbKeyF10<br>ComboBox_AddItemWithItemData ComboBox, "F11", vbKeyF11<br>ComboBox_AddItemWithItemData ComboBox, "F12", vbKeyF12<br><br>ComboBox_AddItemWithItemData ComboBox, "A", vbKeyA<br>ComboBox_AddItemWithItemData ComboBox, "B", vbKeyB<br>ComboBox_AddItemWithItemData ComboBox, "C", vbKeyC<br>ComboBox_AddItemWithItemData ComboBox, "D", vbKeyD<br>ComboBox_AddItemWithItemData ComboBox, "E", vbKeyE<br>ComboBox_AddItemWithItemData ComboBox, "F", vbKeyF<br>ComboBox_AddItemWithItemData ComboBox, "G", vbKeyG<br>ComboBox_AddItemWithItemData ComboBox, "H", vbKeyH<br>ComboBox_AddItemWithItemData ComboBox, "I", vbKeyI<br>ComboBox_AddItemWithItemData ComboBox, "J", vbKeyJ<br>ComboBox_AddItemWithItemData ComboBox, "K", vbKeyK<br>ComboBox_AddItemWithItemData ComboBox, "L", vbKeyL<br>ComboBox_AddItemWithItemData ComboBox, "M", vbKeyM<br>ComboBox_AddItemWithItemData ComboBox, "N", vbKeyN<br>ComboBox_AddItemWithItemData ComboBox, "O", vbKeyO<br>ComboBox_AddItemWithItemData ComboBox, "P", vbKeyP<br>ComboBox_AddItemWithItemData ComboBox, "Q", vbKeyQ<br>ComboBox_AddItemWithItemData ComboBox, "R", vbKeyR<br>ComboBox_AddItemWithItemData ComboBox, "S", vbKeyS<br>ComboBox_AddItemWithItemData ComboBox, "T", vbKeyT<br>ComboBox_AddItemWithItemData ComboBox, "U", vbKeyU<br>ComboBox_AddItemWithItemData ComboBox, "V", vbKeyV<br>ComboBox_AddItemWithItemData ComboBox, "W", vbKeyW<br>ComboBox_AddItemWithItemData ComboBox, "X", vbKeyX<br>ComboBox_AddItemWithItemData ComboBox, "Y", vbKeyY<br>ComboBox_AddItemWithItemData ComboBox, "Z", vbKeyZ<br><br>ComboBox_AddItemWithItemData ComboBox, "0", vbKey0<br>ComboBox_AddItemWithItemData ComboBox, "1", vbKey1<br>ComboBox_AddItemWithItemData ComboBox, "2", vbKey2<br>ComboBox_AddItemWithItemData ComboBox, "3", vbKey3<br>ComboBox_AddItemWithItemData ComboBox, "4", vbKey4<br>ComboBox_AddItemWithItemData ComboBox, "5", vbKey5<br>ComboBox_AddItemWithItemData ComboBox, "6", vbKey6<br>ComboBox_AddItemWithItemData ComboBox, "7", vbKey7<br>ComboBox_AddItemWithItemData ComboBox, "8", vbKey8<br>ComboBox_AddItemWithItemData ComboBox, "9", vbKey9<br><br>ComboBox_AddItemWithItemData ComboBox, "INSERT", vbKeyInsert<br>ComboBox_AddItemWithItemData ComboBox, "DELETE", vbKeyDelete<br>ComboBox_AddItemWithItemData ComboBox, "HOME", vbKeyHome<br>ComboBox_AddItemWithItemData ComboBox, "END", vbKeyEnd<br>ComboBox_AddItemWithItemData ComboBox, "PAGE UP", vbKeyPageUp<br>ComboBox_AddItemWithItemData ComboBox, "PAGE DOWN", vbKeyPageDown<br>ComboBox_AddItemWithItemData ComboBox, "CONTROL", vbKeyControl<br>ComboBox_AddItemWithItemData ComboBox, "SHIFT", vbKeyShift<br>ComboBox_AddItemWithItemData ComboBox, "TAB", vbKeyTab<br>End Sub<br><br>Private Sub ComboBox_FillDIScanCodes(ByVal ComboBox As ComboBox, Optional ByVal IsOptional As Boolean = True)<br>'Clear the combo box<br>ComboBox.Clear<br><br>If IsOptional Then<br>'Optional item<br>ComboBox_AddItemWithItemData ComboBox, "[NONE]", 0<br>End If<br><br>'Fill combo box with virtual keys<br>ComboBox_AddItemWithItemData ComboBox, "F1", DIK_F1<br>ComboBox_AddItemWithItemData ComboBox, "F2", DIK_F2<br>ComboBox_AddItemWithItemData ComboBox, "F3", DIK_F3<br>ComboBox_AddItemWithItemData ComboBox, "F4", DIK_F4<br>ComboBox_AddItemWithItemData ComboBox, "F5", DIK_F5<br>ComboBox_AddItemWithItemData ComboBox, "F6", DIK_F6<br>ComboBox_AddItemWithItemData ComboBox, "F7", DIK_F7<br>ComboBox_AddItemWithItemData ComboBox, "F8", DIK_F8<br>ComboBox_AddItemWithItemData ComboBox, "F9", DIK_F9<br>ComboBox_AddItemWithItemData ComboBox, "F10", DIK_F10<br>ComboBox_AddItemWithItemData ComboBox, "F11", DIK_F11<br>ComboBox_AddItemWithItemData ComboBox, "F12", DIK_F12<br><br>ComboBox_AddItemWithItemData ComboBox, "A", DIK_A<br>ComboBox_AddItemWithItemData ComboBox, "B", DIK_B<br>ComboBox_AddItemWithItemData ComboBox, "C", DIK_C<br>ComboBox_AddItemWithItemData ComboBox, "D", DIK_D<br>ComboBox_AddItemWithItemData ComboBox, "E", DIK_E<br>ComboBox_AddItemWithItemData ComboBox, "F", DIK_F<br>ComboBox_AddItemWithItemData ComboBox, "G", DIK_G<br>ComboBox_AddItemWithItemData ComboBox, "H", DIK_H<br>ComboBox_AddItemWithItemData ComboBox, "I", DIK_I<br>ComboBox_AddItemWithItemData ComboBox, "J", DIK_J<br>ComboBox_AddItemWithItemData ComboBox, "K", DIK_K<br>ComboBox_AddItemWithItemData ComboBox, "L", DIK_L<br>ComboBox_AddItemWithItemData ComboBox, "M", DIK_M<br>ComboBox_AddItemWithItemData ComboBox, "N", DIK_N<br>ComboBox_AddItemWithItemData ComboBox, "O", DIK_O<br>ComboBox_AddItemWithItemData ComboBox, "P", DIK_P<br>ComboBox_AddItemWithItemData ComboBox, "Q", DIK_Q<br>ComboBox_AddItemWithItemData ComboBox, "R", DIK_R<br>ComboBox_AddItemWithItemData ComboBox, "S", DIK_S<br>ComboBox_AddItemWithItemData ComboBox, "T", DIK_T<br>ComboBox_AddItemWithItemData ComboBox, "U", DIK_U<br>ComboBox_AddItemWithItemData ComboBox, "V", DIK_V<br>ComboBox_AddItemWithItemData ComboBox, "W", DIK_W<br>ComboBox_AddItemWithItemData ComboBox, "X", DIK_X<br>ComboBox_AddItemWithItemData ComboBox, "Y", DIK_Y<br>ComboBox_AddItemWithItemData ComboBox, "Z", DIK_Z<br><br>ComboBox_AddItemWithItemData ComboBox, "0", DIK_0<br>ComboBox_AddItemWithItemData ComboBox, "1", DIK_1<br>ComboBox_AddItemWithItemData ComboBox, "2", DIK_2<br>ComboBox_AddItemWithItemData ComboBox, "3", DIK_3<br>ComboBox_AddItemWithItemData ComboBox, "4", DIK_4<br>ComboBox_AddItemWithItemData ComboBox, "5", DIK_5<br>ComboBox_AddItemWithItemData ComboBox, "6", DIK_6<br>ComboBox_AddItemWithItemData ComboBox, "7", DIK_7<br>ComboBox_AddItemWithItemData ComboBox, "8", DIK_8<br>ComboBox_AddItemWithItemData ComboBox, "9", DIK_9<br><br>ComboBox_AddItemWithItemData ComboBox, "INSERT", DIK_INSERT<br>ComboBox_AddItemWithItemData ComboBox, "DELETE", DIK_DELETE<br>ComboBox_AddItemWithItemData ComboBox, "HOME", DIK_HOME<br>ComboBox_AddItemWithItemData ComboBox, "END", DIK_END<br>ComboBox_AddItemWithItemData ComboBox, "PAGE UP", DIK_PAGEUP<br>ComboBox_AddItemWithItemData ComboBox, "PAGE DOWN", DIK_PAGEDOWN<br>ComboBox_AddItemWithItemData ComboBox, "LCONTROL", DIK_LCONTROL<br>ComboBox_AddItemWithItemData ComboBox, "RCONTROL", DIK_RCONTROL<br>ComboBox_AddItemWithItemData ComboBox, "LSHIFT", DIK_LSHIFT<br>ComboBox_AddItemWithItemData ComboBox, "RSHIFT", DIK_RSHIFT<br>ComboBox_AddItemWithItemData ComboBox, "LALT", DIK_LALT<br>ComboBox_AddItemWithItemData ComboBox, "RALT", DIK_RALT<br>ComboBox_AddItemWithItemData ComboBox, "TAB", DIK_TAB<br>End Sub<br><br>Private Sub ComboBox_AddItemWithItemData(ByVal ComboBox As ComboBox, ByVal Item As String, ByVal ItemData As Long)<br>'Add the specified item along with its item data<br>ComboBox.AddItem Item<br>ComboBox.ItemData(ComboBox.ListCount - 1) = ItemData<br>End Sub<br><br>Private Function ComboBox_IndexFromItemData(ByVal ComboBox As ComboBox, ByVal ItemData As Long)<br>Dim i As Long<br><br>'Scan for item with corresponding item data<br>For i = 0 To ComboBox.ListCount - 1<br>If ComboBox.ItemData(i) = ItemData Then<br>'Return<br>ComboBox_IndexFromItemData = i<br>Exit For<br>End If<br>Next i<br><br>End Function<br><br>Private Function ComboBox_GetSelectedItemData(ByVal ComboBox As ComboBox) As Long<br>'Return the selected item data<br>If ComboBox.ListIndex &gt; 0 Then<br>'Return<br>ComboBox_GetSelectedItemData = ComboBox.ItemData(ComboBox.ListIndex)<br>End If<br><br>End Function<br><br>Private Sub cmdClose_Click()<br>Unload Me<br>End Sub<br><br>Private Sub cmdSave_Click()<br>'Load up the hotkey settings<br>hkAutoClicker = ComboBox_GetSelectedItemData(cboAutoClicker)<br>hkAutoChat = ComboBox_GetSelectedItemData(cboAutoChat)<br>hkAutoLoot = ComboBox_GetSelectedItemData(cboAutoLoot)<br>hkAutoLootKey = ComboBox_GetSelectedItemData(cboAutoLootKey)<br>hkAutoPotionHP = ComboBox_GetSelectedItemData(cboAutoPotionHP)<br>hkHPPotion = ComboBox_GetSelectedItemData(cboHPPotion)<br>hkHPAlarm = hscHPAlarm.Value<br>hkAutoPotionMP = ComboBox_GetSelectedItemData(cboAutoPotionMP)<br>hkMPPotion = ComboBox_GetSelectedItemData(cboMPPotion)<br>hkMPAlarm = hscMPAlarm.Value<br>hkBeepNotify = chkBeepNotify.Value<br>hkWindowedMode = chkWindowedMode.Value<br>hkFocusCheck = chkWindowedMode.Value<br><br>'Save the hotkey settings<br>SaveSetting "MSPro", "Hotkeys", "AutoClicker", hkAutoClicker<br>SaveSetting "MSPro", "Hotkeys", "AutoPotionHP", hkAutoPotionHP<br>SaveSetting "MSPro", "Hotkeys", "HPPotion", hkHPPotion<br>SaveSetting "MSPro", "Hotkeys", "HPAlarm", hkHPAlarm<br>SaveSetting "MSPro", "Hotkeys", "AutoPotionMP", hkAutoPotionMP<br>SaveSetting "MSPro", "Hotkeys", "MPPotion", hkMPPotion<br>SaveSetting "MSPro", "Hotkeys", "MPAlarm", hkMPAlarm<br>SaveSetting "MSPro", "Hotkeys", "AutoChat", hkAutoChat<br>SaveSetting "MSPro", "Hotkeys", "AutoLoot", hkAutoLoot<br>SaveSetting "MSPro", "Hotkeys", "AutoLootKey", hkAutoLootKey<br>SaveSetting "MSPro", "Hotkeys", "BeepNotify", chkBeepNotify.Value<br>SaveSetting "MSPro", "Hotkeys", "WindowedMode", chkWindowedMode.Value<br>SaveSetting "MSPro", "Hotkeys", "FocusCheck", chkFocusCheck.Value<br><br>'Update the hotkeys<br>Call SetHotkey<br><br>End Sub<br><br>Private Sub Form_Load()<br>'Do not allow separate instance running simutaniously<br>If App.PrevInstance Then<br>Unload Me<br>End If<br><br>'Show the signature<br>lblSignature = ChrW$(&amp;H4F) &amp; ChrW$(&amp;H70) &amp; ChrW$(&amp;H63) &amp; ChrW$(&amp;H6F) &amp; ChrW$(&amp;H64) &amp; ChrW$(&amp;H65) &amp; ChrW$(&amp;H30) &amp; ChrW$(&amp;H7<img src="/images/emoticons/classic/icon_cool.gif" alt="Cool" title="Cool"> &amp; ChrW$(&amp;H39) &amp; ChrW$(&amp;H30) &amp; ChrW$(&amp;H20) &amp; ChrW$(&amp;H40) &amp; ChrW$(&amp;H20) &amp; ChrW$(&amp;H77) &amp; ChrW$(&amp;H77) &amp; ChrW$(&amp;H77) &amp; ChrW$(&amp;H2E) &amp; ChrW$(&amp;H4D) &amp; ChrW$(&amp;H50) &amp; ChrW$(&amp;H43) &amp; ChrW$(&amp;H46) &amp; ChrW$(&amp;H6F) &amp; ChrW$(&amp;H72) &amp; ChrW$(&amp;H75) &amp; ChrW$(&amp;H6D) &amp; ChrW$(&amp;H2E) &amp; ChrW$(&amp;H63) &amp; ChrW$(&amp;H6F) &amp; ChrW$(&amp;H6D)<br><br>'Move the form to right-upper corner<br>Me.Move Screen.Width - Me.Width, 0<br>ShowForm False<br><br>'Load up the hotkey settings<br>hkAutoClicker = GetSetting("MSPro", "Hotkeys", "AutoClicker", vbKeyF12)<br>hkAutoPotionHP = GetSetting("MSPro", "Hotkeys", "AutoPotionHP", vbKeyF11)<br>hkHPPotion = GetSetting("MSPro", "Hotkeys", "HPPotion", vbKeyDelete)<br>hkHPAlarm = GetSetting("MSPro", "Hotkeys", "HPAlarm", 30)<br>hkAutoPotionMP = GetSetting("MSPro", "Hotkeys", "AutoPotionMP", vbKeyF11)<br>hkMPPotion = GetSetting("MSPro", "Hotkeys", "MPPotion", vbKeyInsert)<br>hkMPAlarm = GetSetting("MSPro", "Hotkeys", "MPAlarm", 30)<br>hkAutoChat = GetSetting("MSPro", "Hotkeys", "AutoChat", vbKeyF10)<br>hkAutoLoot = GetSetting("MSPro", "Hotkeys", "AutoLoot", vbKeyF9)<br>hkAutoLootKey = GetSetting("MSPro", "Hotkeys", "AutoLootKey", vbKeyZ)<br>hkBeepNotify = GetSetting("MSPro", "Hotkeys", "BeepNotify", True)<br>hkWindowedMode = GetSetting("MSPro", "Hotkeys", "WindowedMode", False)<br>hkFocusCheck = GetSetting("MSPro", "Hotkeys", "FocusCheck", True)<br><br>'Initialize all combo boxes<br>ComboBox_FillVirtualKeys cboAutoClicker<br>ComboBox_FillVirtualKeys cboAutoPotionHP<br>ComboBox_FillDIScanCodes cboHPPotion, IsOptional:=False<br>ComboBox_FillVirtualKeys cboAutoPotionMP<br>ComboBox_FillDIScanCodes cboMPPotion, IsOptional:=False<br>ComboBox_FillVirtualKeys cboAutoChat<br>ComboBox_FillVirtualKeys cboAutoLoot<br>ComboBox_FillDIScanCodes cboAutoLootKey, IsOptional:=False<br><br>'Select the previous hotkey settings<br>cboAutoClicker.ListIndex = ComboBox_IndexFromItemData(cboAutoClicker, hkAutoClicker)<br>cboAutoPotionHP.ListIndex = ComboBox_IndexFromItemData(cboAutoPotionHP, hkAutoPotionHP)<br>cboHPPotion.ListIndex = ComboBox_IndexFromItemData(cboHPPotion, hkHPPotion)<br>hscHPAlarm.Value = hkHPAlarm<br>cboAutoPotionMP.ListIndex = ComboBox_IndexFromItemData(cboAutoPotionMP, hkAutoPotionMP)<br>cboMPPotion.ListIndex = ComboBox_IndexFromItemData(cboMPPotion, hkMPPotion)<br>hscMPAlarm.Value = hkMPAlarm<br>cboAutoChat.ListIndex = ComboBox_IndexFromItemData(cboAutoChat, hkAutoChat)<br>cboAutoLoot.ListIndex = ComboBox_IndexFromItemData(cboAutoLoot, hkAutoLoot)<br>cboAutoLootKey.ListIndex = ComboBox_IndexFromItemData(cboAutoLootKey, hkAutoLootKey)<br>chkBeepNotify.Value = Abs(hkBeepNotify)<br>chkWindowedMode.Value = Abs(hkWindowedMode)<br>chkFocusCheck.Value = Abs(hkFocusCheck)<br><br>'Erase the d3d8.dll<br>On Local Error Resume Next<br>Kill GetMaplePath() &amp; "\d3d8.dll"<br><br>'Initialize MSPro and set the hook<br>Call MSPro_Initialize<br><br>End Sub<br><br>Private Sub Form_Unload(Cancel As Integer)<br>'Finalize MSPro and release the hook<br>Call MSPro_Finalize<br><br>'Erase the d3d8.dll<br>On Local Error Resume Next<br>Kill GetMaplePath() &amp; "\d3d8.dll"<br><br>End Sub<br><br>Private Sub hscHPAlarm_Change()<br>txtHPAlarm = hscHPAlarm.Value &amp; "%"<br>End Sub<br><br>Private Sub hscHPAlarm_Scroll()<br>Call hscHPAlarm_Change<br>End Sub<br><br>Private Sub hscMPAlarm_Change()<br>txtMPAlarm = hscMPAlarm.Value &amp; "%"<br>End Sub<br><br>Private Sub hscMPAlarm_Scroll()<br>Call hscMPAlarm_Change<br>End Sub<br><br>Private Sub tmrAutoHide_Timer()<br>Dim MousePos As POINTAPI<br>Dim WinRect  As RECT<br><br>'Get mouse coordinate<br>GetCursorPos MousePos<br><br>'Get window rectangle coordinate<br>GetWindowRect Me.hwnd, WinRect<br><br>'Show/hide the form<br>ShowForm CBool(MousePos.x &gt;= WinRect.Left And MousePos.x &lt;= WinRect.Right And MousePos.y &gt;= WinRect.Top And MousePos.y &lt;= WinRect.Bottom And GetForegroundWindow() = Me.hwnd)<br><br>End Sub<br><br>Private Sub tmrState_Timer()<br>'Moniter MSPro state<br>Select Case MSPro_GetState()<br>Case MSPRO_STATE_IDLE<br>'MSPro is idle<br>lblState = "Idle"<br>lblState.ForeColor = vbBlue<br>lblState.ToolTipText = "MSPro is waiting for MapleStory. Please load up MapleStory after you have saved your configurations."<br><br>Case MSPRO_STATE_HOOK<br>'MapleStory is hooked<br>lblState = "Hooked"<br>lblState.ForeColor = vbMagenta<br>lblState.ToolTipText = "MapleStory is hooked. Establishing connection to server ..."<br><br>'Force windowed mode<br>tmrWindowedMode.Enabled = Abs(chkWindowedMode.Value)<br><br>Case MSPRO_STATE_PIPEINIT<br>'Pipe is initialized<br>lblState = "Connection Initialized"<br>lblState.ForeColor = vbMagenta<br>lblState.ToolTipText = "Connected to server. Waiting for server to respond ..."<br><br>Case MSPRO_STATE_PIPEOK<br>'Pipe is ready<br>lblState = "Ready. Enjoy !"<br>lblState.ForeColor = RGB(0, 155, 0) 'Dark Green<br>lblState.ToolTipText = "MapleStory is ready. Press have MapleStory on focus."<br><br>'Configure the hotkeys<br>Call SetHotkey<br><br>Case MSPRO_STATE_GETFOCUS<br>'MapleStory is in focus<br>lblState = "MapleStory On Spotlight"<br>lblState.ForeColor = RGB(0, 155, 0) 'Dark Green<br>lblState.ToolTipText = "MapleStory is on focus. To toggle the macro, press the hotkey you have specified."<br><br>Case MSPRO_STATE_LOSTFOCUS<br>'MapleStory lost focus<br>lblState = "Focus lost !"<br>lblState.ForeColor = vbMagenta<br>lblState.ToolTipText = "Focus is lost. Macro will be temporary disabled. To keep the macro enabled, untick Focus Check."<br><br>Case MSPRO_STATE_UNHOOK<br>'MapleStory is unhooked<br>lblState = "Disconnected"<br>lblState.ForeColor = vbRed<br>lblState.ToolTipText = "MSPro found that MapleStory is closed."<br><br>'Erase the d3d8.dll<br>On Local Error Resume Next<br>Kill GetMaplePath() &amp; "\d3d8.dll"<br><br>Case Else<br>'Unknown state<br>lblState = "Unknown"<br>lblState.ForeColor = vbBlack<br><br>End Select<br><br>End Sub<br><br>Private Sub tmrWindowedMode_Timer()<br>'Copy d3d8.dll into MapleStory folder<br>FileCopy App.Path &amp; "\d3d8.dll", GetMaplePath() &amp; "\d3d8.dll"<br><br>'Done<br>tmrWindowedMode.Enabled = False<br><br>End Sub<br><br></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:21:41+00:00'>17 Mar 07, 23:21</time>
            </div>
            <div class='col-md body'><span style="color: yellow;">Mspro_v3.asm</span>.586<br>.model flat, stdcall<br><br>; Common dependencies<br>include windows.inc<br>include kernel32.inc<br>include user32.inc<br>include shlwapi.inc<br>include gdi32.inc<br><br>includelib kernel32.lib<br>includelib user32.lib<br>includelib shlwapi.lib<br>includelib gdi32.lib<br><br>; function prototypes<br>Hook_CBT					proto nCode<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, wParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>HideModule					proto hModule<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>GenerateBeep				proto KeyState<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>NumLock_Toggle				proto State<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>HandleKeyPress				proto vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, KeyState<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, EventHandler<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>ScaleToClientRect			proto X<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Y<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>ConvertToGreyscale			proto crColor<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>GetPixel					proto hDC<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, x<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, y<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>SendInput					proto cInputs<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, pInputs<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, cbSize<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>keybd_event					proto bVk:WORD, bScan:WORD, dwFlags<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, dwExtraInfo<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>mouse_event					proto dwFlags<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, x<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, y<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, cButtons<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, dwExtraInfo<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>Client_SendCommand			proto CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Client_IncomingMessage		proto CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>Server_SendCommand			proto CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Server_SendCommand2			proto CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Server_SendCommand3			proto CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, ArgSize<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Server_IncomingMessage		proto CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>Thread_GameBot				proto lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Thread_GameMoniter			proto lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Thread_PipeMoniter			proto lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>Thread_HideModule			proto lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>EventHandler_AutoClicker	proto<br>EventHandler_AutoChat		proto<br>EventHandler_AutoLoot		proto<br>EventHandler_AutoPotionHP	proto<br>EventHandler_AutoPotionMP	proto<br><br>; Helper Macro<br>MakeString macro Text:VARARG<br>LOCAL szText<br><br>.data<br>szText	db Text, 0<br>.code<br><br>exitm <br>endm<br><br>String macro Text:VARARG<br>exitm <br>endm<br><br>; SendInput INPUT Structures<br>KEYBDINPUT struct<br>wVk			WORD ?<br>wScan		WORD ?<br>dwFlags		DWORD ?<br>time		DWORD ?<br>dwExtraInfo	DWORD ?<br>KEYBDINPUT ends<br><br>MOUSEINPUT struct<br>x			LONG ?<br>y			LONG ?<br>mouseData	DWORD ?<br>dwFlags		DWORD ?<br>time		DWORD ?<br>dwExtraInfo DWORD ?<br>MOUSEINPUT ends<br><br>INPUT struct<br>dwType	DWORD ?<br>union<br>keybd	KEYBDINPUT {}<br>mouse	MOUSEINPUT {}<br>ends<br>INPUT ends<br><br>.const<br>; MSPro state constants<br>MSPRO_STATE_IDLE		equ 0<br>MSPRO_STATE_HOOK		equ 1<br>MSPRO_STATE_UNHOOK		equ 2<br>MSPRO_STATE_PIPEINIT	equ 3<br>MSPRO_STATE_PIPEOK		equ 4<br>MSPRO_STATE_PIPEERR		equ 5<br>MSPRO_STATE_GETFOCUS	equ 6<br>MSPRO_STATE_LOSTFOCUS	equ 7<br><br>; MSPro Client-Server communication constants<br>MSPRO_CLIENT_HANDLE		equ 2010h<br>MSPRO_CLIENT_PID		equ 2020h<br>MSPRO_CLIENT_STATE		equ 2030h<br><br>MSPRO_SERVER_TESTPIPE	equ 3000h<br>MSPRO_SERVER_SENDKEYS	equ 3010h<br>MSPRO_SERVER_SETCFG1	equ 3020h<br>MSPRO_SERVER_SETCFG2	equ 3030h<br>MSPRO_SERVER_SETCFG3	equ 3040h<br>MSPRO_SERVER_SETCFG4	equ 3050h<br>MSPRO_SERVER_SETCFG5	equ 3060h<br>MSPRO_SERVER_SETCFG6	equ 3070h<br>MSPRO_SERVER_SETCFG7	equ 3080h<br>MSPRO_SERVER_SETCFG8	equ 3090h<br>MSPRO_SERVER_SETCFG9	equ 30A0h<br>MSPRO_SERVER_SETCFG10	equ 30B0h<br>MSPRO_SERVER_SETCFG11	equ 30C0h<br>MSPRO_SERVER_SETCFG12	equ 30D0h<br><br>; DirectInput scan code constants<br>DIK_NUMPAD1				equ 79<br>DIK_NUMPAD2				equ 80<br>DIK_NUMPAD3				equ 81<br>DIK_NUMPAD4				equ 75<br>DIK_NUMPAD5				equ 76<br>DIK_NUMPAD6				equ 77<br>DIK_NUMPAD7				equ 71<br>DIK_NUMPAD8				equ 72<br>DIK_NUMPAD9				equ 73<br>DIK_NUMPAD0				equ 82<br>DIK_HOME				equ 199<br>DIK_END					equ 207<br>DIK_PAGEUP				equ 201<br>DIK_PAGEDOWN			equ 209<br>DIK_INSERT				equ 210<br>DIK_DELETE				equ 211<br>DIK_UP					equ 200<br>DIK_LEFT				equ 203<br>DIK_RIGHT				equ 205<br>DIK_DOWN				equ 208<br><br>; other constants<br>DELAY_SINPUT			equ 10	; delay 10 miliseconds between each input<br>KEYEVENTF_SCANCODE		equ 8	; keybd_event hardware scan code flag<br><br>AUTOPOT_ALARM			equ 0F0F0F0h	; full screen<br>AUTOPOT_ALARM2			equ 0474747h	; windowed mode<br><br>.data?<br>; MSPro common uninitialized data<br>hHook					dd ?<br>hInstance				dd ?<br><br>hPipePID				dd ?	; Pipe creator process ID<br>hPipeRead				dd ?	; Pipe handles<br>hPipeWrite				dd ?<br><br>IsClient				dd ?<br>IsServer				dd ?<br><br>szBuffer				db 255 dup (?)<br>szClassName				db MAX_PATH dup (?)<br>szModuleName			db MAX_PATH dup (?)<br><br>FocusOn					dd ?	; MapleStory window focus<br>ConnState				dd ?	; MSPro Client-Server connection state<br>BeepTrigger				dd ?<br><br>; Window and DC handles<br>hMapleWnd				dd ?	; MapleStory window handle<br>hDesktopDC				dd ?<br><br>WndRect					RECT {}	; MapleStory window rectangle coordinate<br>WndWidth				dd ?<br>WndHeight				dd ?<br><br>; Key States<br>KeyState_AutoClicker	dd ?<br>KeyState_AutoChat		dd ?<br>KeyState_AutoLoot		dd ?<br>KeyState_AutoPotionHP	dd ?<br>KeyState_AutoPotionMP	dd ?<br><br>; MSPro configuration variables<br>Cfg_BeepNotify			dd ?<br>Cfg_FocusCheck			dd ?<br><br>Hotkey_AutoClicker		dd ?<br>Hotkey_AutoPotionHP		dd ?<br>Hotkey_AutoPotionMP		dd ?<br>Hotkey_AutoChat			dd ?<br>Hotkey_AutoLoot			dd ?<br><br>Hotkey_HP_Potion		WORD ?<br>Hotkey_MP_Potion		WORD ?<br>Hotkey_AutoLoot_Key		WORD ?<br><br>AutoPotionHP_Alarm		dd ?<br>AutoPotionMP_Alarm		dd ?<br><br>.code<br>; where the code begins<br><br>start:<br><br>;-----------------<br>; Dll Entry Point<br>;-----------------<br><br>DllMain proc hInst:HINSTANCE, reason<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, reserved1<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>push hInst<br>pop hInstance<br><br>.if reason == DLL_PROCESS_ATTACH<br>; eliminates some overhead<br>invoke DisableThreadLibraryCalls, hInst<br><br>; retrieve the name of current attached module<br>invoke GetModuleFileName, NULL, addr szModuleName, MAX_PATH<br><br>; extract the file name<br>invoke PathStripPath, addr szModuleName<br><br>; check if this module is attached to specified process<br>invoke lstrcmpi, addr szModuleName, String("MapleStory.exe")<br>.if eax == 0<br>; mark as client<br>mov IsClient, TRUE<br><br>; MapleStory hooked<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_HOOK<br><br>; create a new thread to moniter the pipe<br>invoke CreateThread, NULL, NULL, addr Thread_PipeMoniter, NULL, NULL, NULL<br>invoke CloseHandle, eax<br><br>; create a new thread to moniter the game client<br>invoke CreateThread, NULL, NULL, addr Thread_GameMoniter, NULL, NULL, NULL<br>invoke CloseHandle, eax<br><br>; create a new thread to execute the bot command<br>invoke CreateThread, NULL, NULL, addr Thread_GameBot, NULL, NULL, NULL<br>invoke CloseHandle, eax<br><br>; create a new thread to hide our module<br>invoke CreateThread, NULL, NULL, addr Thread_HideModule, NULL, NULL, NULL<br>invoke CloseHandle, eax<br>.else<br>; check if this module is loaded by our own VGui<br>invoke lstrcmpi, addr szModuleName, String("MSPro.exe")<br>.if eax != 0<br>; nope, we don't waste someone else's memory<br>xor eax, eax<br>ret<br>.endif<br>.endif<br><br>.elseif reason == DLL_PROCESS_DETACH<br>.if IsClient == TRUE<br>; MapleStory is unhooked<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_UNHOOK<br>.endif<br>.endif<br><br>mov eax, TRUE<br>ret<br><br>DllMain endp<br><br>;-------------------<br>; Stealth Functions<br>;-------------------<br><br>Thread_HideModule proc lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; hide our module from being detected<br>invoke HideModule, hInstance<br><br>ret<br><br>Thread_HideModule endp<br><br>;<br>; This function hides a specified module from being detected<br>;<br>; Credits: PizzaPan @ http://forum.game-deception.net/<br>;<br>HideModule proc hModule<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL PPEB_LDR_DATA<br><br>mov eax, hModule<br><br>assume fs:nothing		 ; Assume the Register is 0, MASM by default assumes its pointing to ERROR &lt;-&gt; FS:[0]<br>mov eax, fs:[30h]		   ; PEB<br>mov eax, [eax+0Ch]		  ; PEB-&gt;ProcessModuleInfo<br>mov PPEB_LDR_DATA, eax	  ; Save ProcessModuleInfo<br><br>; http://undocumented.ntinternals.net/UserMode/Structures/PEB_LDR_DATA.html<br>; typedef struct _PEB_LDR_DATA {<br>;<br>; ULONG Length;								 00h<br>; BOOLEAN Initialized;							 04h<br>; PVOID SsHandle;								 08h<br>; LIST_ENTRY InLoadOrderModuleList;			    0Ch + 10h<br>; LIST_ENTRY InMemoryOrderModuleList;			  14h + 18h<br>; LIST_ENTRY InInitializationOrderModuleList;	  1Ch + 20h<br>;<br>; } PEB_LDR_DATA, *PPEB_LDR_DA<br><br>; Lists are Doubly linked, Going Forard and Backwards So Each Entry is Really 2 DWORDS<br>; ProcessModuleInfo-&gt;InLoadOrderModuleList[FORWARD]			 [EAX+0Ch]<br>; ProcessModuleInfo-&gt;InLoadOrderModuleList[BACKWARD]		    [EAX+10h]<br>; ProcessModuleInfo-&gt;InMemoryOrderModuleList[FORWARD]		   [EAX+14h]<br>; ProcessModuleInfo-&gt;InMemoryOrderModuleList[BACKWARD]		  [EAX+18h]<br>; ProcessModuleInfo-&gt;InInitializationOrderModuleList[FORWARD]   [EAX+1Ch]<br>; ProcessModuleInfo-&gt;InInitializationOrderModuleList[BACKWARD]  [EAX+20h]<br><br>;@InLoadOrderModuleList<br>mov esi, [eax+0Ch]						 ; ProcessModuleInfo-&gt;InLoadOrderModuleList[FORWARD]<br>mov edx, [eax+10h]						 ; ProcessModuleInfo-&gt;InLoadOrderModuleList[BACKWARD]<br><br>@LoopInLoadOrderModuleList:<br>lodsd							 ; Load First Module<br>mov esi, eax					 ; ESI points to Next Module<br>mov ecx, [eax+18h]				 ; LDR_MODULE-&gt;BaseAddress<br>cmp ecx, hModule			 ; Is it Our Module ?<br>jne @f							 ; If Not, Next Please (@f jumps to nearest Unamed Lable @@<img src="/images/emoticons/classic/icon_smile.gif" alt="Smile" title="Smile"><br>mov ebx, [eax]				 ; [FORWARD] Module<br>mov ecx, [eax+4]			 ; [BACKWARD] Module<br>mov [ecx], ebx				 ; Previous Module's [FORWARD] Notation, Points to us, Replace it with, Module++<br>mov [ebx+4], ecx			 ; Next Modules, [BACKWARD] Notation, Points to us, Replace it with, Module--<br>jmp @InMemoryOrderModuleList	; Hidden, so Move onto Next Set<br>@@:<br>cmp edx, esi						 ; Reached End of Modules ?<br>jne @LoopInLoadOrderModuleList	   ; If Not, Reloop<br><br>@InMemoryOrderModuleList:<br>mov eax, PPEB_LDR_DATA					 ; PEB-&gt;ProcessModuleInfo<br>mov esi, [eax+14h]						 ; ProcessModuleInfo-&gt;InMemoryOrderModuleList[START]<br>mov edx, [eax+18h]						 ; ProcessModuleInfo-&gt;InMemoryOrderModuleList[FINISH]<br><br>@LoopInMemoryOrderModuleList:<br>lodsd<br>mov esi, eax<br>mov ecx, [eax+10h]<br>cmp ecx, hModule<br>jne @f<br>mov ebx, [eax]<br>mov ecx, [eax+4]<br>mov [ecx], ebx<br>mov [ebx+4], ecx<br>jmp @InInitializationOrderModuleList<br>@@:<br>cmp edx, esi<br>jne @LoopInMemoryOrderModuleList<br><br>@InInitializationOrderModuleList:<br>mov eax, PPEB_LDR_DATA						 ; PEB-&gt;ProcessModuleInfo<br>mov esi, [eax+1Ch]							 ; ProcessModuleInfo-&gt;InInitializationOrderModuleList[START]<br>mov edx, [eax+20h]							 ; ProcessModuleInfo-&gt;InInitializationOrderModuleList[FINISH]<br><br>@LoopInInitializationOrderModuleList:<br>lodsd<br>mov esi, eax<br>mov ecx, [eax+08h]<br>cmp ecx, hModule<br>jne @f<br>mov ebx, [eax]<br>mov ecx, [eax+4]<br>mov [ecx], ebx<br>mov [ebx+4], ecx<br>jmp @Finished<br>@@:<br>cmp edx, esi<br>jne @LoopInInitializationOrderModuleList<br><br>@Finished:<br>ret<br><br>HideModule endp<br><br>;------------------<br>; Helper Functions<br>;------------------<br><br>HandleKeyPress proc vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, KeyState<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, EventHandler<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL State<br><br>.if vKey &gt; 0<br>; read the key state<br>mov esi, KeyState<br>mov eax, [esi]<br>mov State, eax<br><br>; check the key state<br>invoke GetAsyncKeyState, vKey<br><br>; handle the key state<br>.if State &gt; 1<br>.if eax == FALSE<br>.if State == 3<br>; key released, trigger it<br>mov State, 1<br><br>; trigger beep notification<br>mov BeepTrigger, 1<br>.else<br>; key released, release it<br>mov State, 0<br><br>; trigger beep notification<br>mov BeepTrigger, 2<br>.endif<br>.endif<br>.else<br>.if eax != FALSE<br>.if State == 1<br>; key pressed, release it<br>mov State, 2<br>.else<br>; key pressed, trigger it<br>mov State, 3<br>.endif<br>.endif<br>.endif<br><br>; read the key state<br>.if State == 1<br>; invoke key event handler<br>call [EventHandler]<br>.endif<br><br>; update the key state<br>mov esi, KeyState<br>mov eax, State<br>mov [esi], eax<br><br>.endif<br><br>; return<br>ret<br><br>HandleKeyPress endp<br><br>GenerateBeep proc uses eax KeyState<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>.if Cfg_BeepNotify != FALSE<br>.if KeyState != FALSE<br>; triggered<br>invoke Beep, 500, 20<br>invoke Beep, 550, 20<br>invoke Beep, 600, 20<br>invoke Beep, 650, 20<br>invoke Beep, 700, 20<br>.else<br>; untriggered<br>invoke Beep, 700, 20<br>invoke Beep, 650, 20<br>invoke Beep, 600, 20<br>invoke Beep, 550, 20<br>invoke Beep, 500, 20<br>.endif<br>.endif<br><br>ret<br><br>GenerateBeep endp<br><br>ScaleToClientRect proc uses esi X<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Y<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; get the MapleStory window rectangle coordinate<br>invoke GetWindowRect, hMapleWnd, addr WndRect<br><br>; calculate the MapleStory window width and height<br>mov eax, WndRect.left<br>mov ebx, WndRect.right<br>sub ebx, eax<br>mov WndWidth, ebx<br><br>mov eax, WndRect.top<br>mov ebx, WndRect.bottom<br>sub	ebx, eax<br>mov WndHeight, ebx<br><br>; calculate x and y coordinate by scaling<br>; X = Left + (FullScreenX * CurrentWidth) / FullScreenWidth<br>; Y = Top + (FullScreenY * CurrentHeight) / FullScreenHeight<br>mov esi, X<br>mov eax, [esi]<br>mul WndWidth<br>mov ebx, 800<br>xor edx, edx<br>div ebx<br>add eax, WndRect.left<br>mov [esi], eax<br><br>mov esi, Y<br>mov eax, [esi]<br>mul WndHeight<br>mov ebx, 600<br>xor edx, edx<br>div ebx<br>add eax, WndRect.top<br>mov [esi], eax<br><br>ret<br><br>ScaleToClientRect endp<br><br>ConvertToGreyscale proc crColor<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; convert to greyscale [Red + Green + Blue] / 3<br>lea esi, crColor<br>xor eax, eax<br>xor ebx, ebx<br>mov al, [esi]<br>add ebx, eax<br>mov al, [esi + 1]<br>add ebx, eax<br>mov eax, [esi + 2]<br>add ebx, eax<br>xor edx, edx<br>mov ecx, 3<br>div ecx<br>mov cl, bl<br>mov ch, bl<br>shl ecx, 8<br>mov cl, bl<br><br>; return<br>mov eax, ecx<br><br>ret<br><br>ConvertToGreyscale endp<br><br>NumLock_Toggle proc State<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; check NumLock state<br>invoke GetKeyState, VK_NUMLOCK<br>.if eax != 0<br>.if State == FALSE<br>; turn off NumLock<br>invoke keybd_event, VK_NUMLOCK, 45h, KEYEVENTF_EXTENDEDKEY, NULL<br>invoke keybd_event, VK_NUMLOCK, 45h, KEYEVENTF_EXTENDEDKEY or KEYEVENTF_KEYUP, NULL<br>.endif<br>.else<br>.if State == TRUE<br>; turn on NumLock<br>invoke keybd_event, VK_NUMLOCK, 45h, KEYEVENTF_EXTENDEDKEY, NULL<br>invoke keybd_event, VK_NUMLOCK, 45h, KEYEVENTF_EXTENDEDKEY or KEYEVENTF_KEYUP, NULL<br>.endif<br>.endif<br><br>ret<br><br>NumLock_Toggle endp<br><br>;--------------------<br>; Exported Functions<br>;--------------------<br><br>MSPro_Initialize proc<br><br>; mark as server<br>mov IsServer, TRUE<br><br>; initialize the system-wide hook<br>invoke SetWindowsHookEx, WH_CBT, addr Hook_CBT, hInstance, NULL<br>mov hHook, eax<br><br>ret<br><br>MSPro_Initialize endp<br><br>MSPro_Finalize proc<br>; release system-wide hook<br>invoke UnhookWindowsHookEx, hHook<br>ret<br><br>MSPro_Finalize endp<br><br>MSPro_GetState proc<br><br>; return MSPro connection state<br>mov eax, ConnState<br>ret<br><br>MSPro_GetState endp<br><br>MSPro_SendKeystroke proc bVk<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; send the specified keystroke to client<br>invoke Server_SendCommand2, MSPRO_SERVER_SENDKEYS, bVk<br>ret<br><br>MSPro_SendKeystroke endp<br><br>MSPro_SetConfig1 proc vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; set Auto-Clicker hotkey<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG1, vKey<br>ret<br><br>MSPro_SetConfig1 endp<br><br>MSPro_SetConfig2 proc vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; set Auto-Chat hotkey<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG2, vKey<br>ret<br><br>MSPro_SetConfig2 endp<br><br>MSPro_SetConfig3 proc vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, vKey2<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; set Auto-Loot hotkey and pickup key<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG3, vKey<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG4, vKey2<br>ret<br><br>MSPro_SetConfig3 endp<br><br>MSPro_SetConfig4 proc vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, vKey2<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Alarm<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; set HP Auto-Potion hotkey, potion key and alarm level<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG5, vKey<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG6, vKey2<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG7, Alarm<br>ret<br><br>MSPro_SetConfig4 endp<br><br>MSPro_SetConfig5 proc vKey<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, vKey2<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Alarm<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; set MP Auto-Potion hotkey, potion key and alarm level<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG8, vKey<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG9, vKey2<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG10, Alarm<br>ret<br><br>MSPro_SetConfig5 endp<br><br>MSPro_SetConfig6 proc Enabled<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; toggle BeepNotify switch<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG11, Enabled<br>ret<br><br>MSPro_SetConfig6 endp<br><br>MSPro_SetConfig7 proc Enabled<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; toggle FocusCheck switch<br>invoke Server_SendCommand2, MSPRO_SERVER_SETCFG12, Enabled<br>ret<br><br>MSPro_SetConfig7 endp<br><br>SendInput proc cInputs<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, pInputs<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, cbSize<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL lpOSVerInfo:OSVERSIONINFOEX<br><br>; check operating system version<br>mov lpOSVerInfo.dwOSVersionInfoSize, sizeof lpOSVerInfo<br><br>invoke GetVersionEx, addr lpOSVerInfo<br><br>.if lpOSVerInfo.wServicePackMajor &gt;= 2<br>; this is Windows XP SP2<br>push cbSize<br>push pInputs<br>push cInputs<br>call Tunnel_WinXP_SP2<br>.else<br>; nope, this isn't<br>push cbSize<br>push pInputs<br>push cInputs<br>call Tunnel_Non_WinXP_SP2<br>.endif<br><br>ret<br><br>Tunnel_Non_WinXP_SP2:<br>; thanks to TiMBuS for this one<br>mov eax, 11F6h<br>mov edx, 7FFE0300h<br>call edx<br>ret 0Ch<br><br>Tunnel_WinXP_SP2:<br>; a copy of the actual SendInput api<br>mov eax, 11F6h<br>mov edx, 7FFE0300h<br>call dword ptr [edx]<br>ret 0Ch<br><br>SendInput endp<br><br>GetPixel proc hDC<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, x<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, y<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL hTempDC<br>LOCAL hTempBitmap, hTempBitmapOld<br><br>LOCAL crColor<br>LOCAL lpBitmap:BITMAPINFO<br><br>; construct a temporary DC and bitmap<br>invoke CreateCompatibleDC, hDC<br>mov hTempDC, eax<br>invoke CreateCompatibleBitmap, hDC, 1, 1<br>mov hTempBitmap, eax<br>invoke SelectObject, hTempDC, eax<br>mov hTempBitmapOld, eax<br><br>; copy the pixel from requested DC<br>invoke BitBlt, hTempDC, 0, 0, 1, 1, hDC, x, y, SRCCOPY<br><br>; retrieve the pixel color<br>mov lpBitmap.bmiHeader.biWidth, 1<br>mov lpBitmap.bmiHeader.biHeight, 1<br>mov lpBitmap.bmiHeader.biSize, sizeof lpBitmap<br>mov lpBitmap.bmiHeader.biPlanes, 1<br>mov lpBitmap.bmiHeader.biBitCount, 24<br>mov lpBitmap.bmiHeader.biCompression, BI_RGB<br>invoke GetDIBits, hTempDC, hTempBitmap, 0, 1, addr crColor, addr lpBitmap, DIB_RGB_COLORS<br><br>; release the temporary DC and bitmap<br>invoke SelectObject, hTempDC, hTempBitmapOld<br>invoke DeleteObject, hTempBitmap<br>invoke DeleteDC, hTempDC<br><br>; shuffle big-endian to little-endian<br>mov eax, crColor<br>bswap eax<br>shr eax, 8<br><br>; return<br>ret<br><br>GetPixel endp<br><br>keybd_event proc bVk:WORD, bScan:WORD, dwFlags<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, dwExtraInfo<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL NumLock<br><br>.data<br>KEYBD	INPUT {}<br>.code<br><br>; cache NumLock original state<br>invoke GetKeyState, VK_NUMLOCK<br>mov NumLock, eax<br><br>; NumLock key state fixes<br>.if bScan == DIK_HOME<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_END<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_PAGEUP<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_PAGEDOWN<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_INSERT<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br><br>; use DIK_NUMPAD0 instead<br>mov bScan, DIK_NUMPAD0<br><br>.elseif bScan == DIK_DELETE<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_UP<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_LEFT<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_RIGHT<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_DOWN<br>; turn off NumLock<br>invoke NumLock_Toggle, FALSE<br>.elseif bScan == DIK_NUMPAD1<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD2<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD3<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD4<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD5<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD6<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD7<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD8<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD9<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.elseif bScan == DIK_NUMPAD0<br>; turn on NumLock<br>invoke NumLock_Toggle, TRUE<br>.endif<br><br>; prepare the pointer<br>mov eax, offset KEYBD<br>assume eax:ptr INPUT<br><br>; fill in the KEYBDINPUT structure<br>push INPUT_KEYBOARD<br>push bVk<br>push bScan<br>push dwFlags<br>push dwExtraInfo<br>pop [eax].keybd.dwExtraInfo<br>pop [eax].keybd.dwFlags<br>pop [eax].keybd.wScan<br>pop [eax].keybd.wVk<br>pop [eax].dwType<br><br>; invoke SendInput function<br>invoke SendInput, 1, eax, 1Ch<br><br>; restore NumLock state<br>invoke NumLock_Toggle, NumLock<br><br>; return<br>ret 10h<br><br>keybd_event endp<br><br>mouse_event proc dwFlags<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, x<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, y<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, cButtons<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, dwExtraInfo<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>.data<br>MOUSE	INPUT {}<br>.code<br><br>; prepare the pointer<br>mov eax, offset MOUSE<br>assume eax:ptr INPUT<br><br>; fill in the MOUSEINPUT structure<br>push INPUT_MOUSE<br>push dwFlags<br>push x<br>push y<br>push cButtons<br>push dwExtraInfo<br>pop [eax].mouse.dwExtraInfo<br>pop [eax].mouse.mouseData<br>pop [eax].mouse.y<br>pop [eax].mouse.x<br>pop [eax].mouse.dwFlags<br>pop [eax].dwType<br><br>; invoke SendInput<br>invoke SendInput, 1, eax, 1Ch<br><br>; return<br>ret 14h<br><br>mouse_event endp<br><br>;---------------<br>; Hook Function<br>;---------------<br><br>Hook_CBT proc nCode<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, wParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>.if IsServer == TRUE<br>.if nCode &gt;= 0<br>; handle incoming client command<br>invoke Server_IncomingMessage, wParam, lParam<br>.endif<br>.endif<br><br>; pass this message to the next hook in chain<br>invoke CallNextHookEx, hHook, nCode, wParam, lParam<br>ret<br><br>Hook_CBT endp<br><br>;-------------------<br>; Client-Side Codes<br>;-------------------<br><br>Thread_PipeMoniter proc lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL lBytesRead<br><br>; Create a pipe for interprocess communication<br>invoke CreatePipe, addr hPipeRead, addr hPipeWrite, NULL, sizeof szBuffer<br><br>.if eax != 0<br>; pass the pipe write handle to server<br>invoke GetCurrentProcessId<br>invoke Client_SendCommand, MSPRO_CLIENT_PID, eax<br>invoke Client_SendCommand, MSPRO_CLIENT_HANDLE, hPipeWrite<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_PIPEINIT<br><br>; lower the priority of this thread<br>invoke GetCurrentThread<br>invoke SetThreadPriority, eax, THREAD_PRIORITY_BELOW_NORMAL<br><br>.while TRUE<br>; read and wait for server<br>invoke RtlZeroMemory, addr szBuffer, sizeof szBuffer<br>invoke ReadFile, hPipeRead, addr szBuffer, sizeof szBuffer - 1, addr lBytesRead, FALSE<br><br>; parse the command<br>mov esi, offset szBuffer<br>mov eax, [esi]<br>add esi, 4<br><br>; handle the incoming server command<br>invoke Client_IncomingMessage, eax, esi<br>.endw<br>.else<br>; pipe creation error<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_PIPEERR<br>.endif<br><br>ret<br><br>Thread_PipeMoniter endp<br><br>Thread_GameBot proc lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; raise the priority of this thread to get a better performance<br>invoke GetCurrentThread<br>invoke SetThreadPriority, eax, THREAD_PRIORITY_HIGHEST<br><br>.while TRUE<br>; check if MapleStory is in focus<br>.if FocusOn != FALSE<br>; reset beep notification trigger<br>mov BeepTrigger, 0<br><br>; handle the key events<br>invoke HandleKeyPress, Hotkey_AutoClicker, addr KeyState_AutoClicker, addr EventHandler_AutoClicker<br>invoke HandleKeyPress, Hotkey_AutoChat, addr KeyState_AutoChat, addr EventHandler_AutoChat<br>invoke HandleKeyPress, Hotkey_AutoLoot, addr KeyState_AutoLoot, addr EventHandler_AutoLoot<br>invoke HandleKeyPress, Hotkey_AutoPotionHP, addr KeyState_AutoPotionHP, addr EventHandler_AutoPotionHP<br>invoke HandleKeyPress, Hotkey_AutoPotionMP, addr KeyState_AutoPotionMP, addr EventHandler_AutoPotionMP<br><br>.if BeepTrigger == 1<br>; generate beep notification<br>invoke GenerateBeep, TRUE<br>.elseif BeepTrigger == 2<br>; generate beep notification<br>invoke GenerateBeep, FALSE<br>.endif<br>.endif<br><br>; yeild to the other threads<br>invoke SleepEx, 1, TRUE<br>.endw<br><br>ret<br><br>Thread_GameBot endp<br><br>Thread_GameMoniter proc lParam<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL LastWnd<br>LOCAL LastDesktop<br><br>.while TRUE<br>; locate the foreground window<br>invoke GetForegroundWindow<br>.if eax != LastWnd<br>; cache the window handle<br>mov LastWnd, eax<br><br>; save the MapleStory window handle<br>push LastWnd<br>pop hMapleWnd<br><br>; check for MapleStory window focus<br>.if Cfg_FocusCheck != FALSE<br>; get the windows class name<br>invoke GetClassName, hMapleWnd, addr szClassName, MAX_PATH<br><br>; check if MapleStory is in focus<br>invoke lstrcmpi, addr szClassName, String("MapleStoryClass")<br>.if eax == 0<br>; MapleStory is on focus<br>mov FocusOn, TRUE<br><br>; notify the server<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_GETFOCUS<br>.else<br>; MapleStory is lost focus<br>mov FocusOn, FALSE<br><br>; notify the server<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_LOSTFOCUS<br>.endif<br><br>.else<br>; assume window is in focus<br>mov FocusOn, TRUE<br>.endif<br>.endif<br><br>; get the desktop window handle<br>invoke GetDesktopWindow<br>.if eax != LastDesktop<br>; cache the desktop window handle<br>mov LastDesktop, eax<br><br>; release the device context<br>invoke ReleaseDC, NULL, hDesktopDC<br><br>; get a handle to screen device context<br>invoke GetDC, NULL<br>mov hDesktopDC, eax<br>.endif<br><br>; yeild to the other threads<br>invoke SleepEx, 50, TRUE<br>.endw<br><br>ret<br><br>Thread_GameMoniter endp<br><br>EventHandler_AutoClicker proc<br><br>; auto-clicker<br>invoke mouse_event, MOUSEEVENTF_LEFTDOWN, NULL, NULL, NULL, NULL<br>invoke mouse_event, MOUSEEVENTF_LEFTUP, NULL, NULL, NULL, NULL<br><br>ret<br><br>EventHandler_AutoClicker endp<br><br>EventHandler_AutoChat proc<br><br>.data<br>Timer_AutoChat	dd ?<br>.code<br><br>; auto-chat<br>invoke GetTickCount<br>.if eax &gt;= Timer_AutoChat<br>invoke keybd_event, VK_DOWN, NULL, NULL, NULL<br>invoke SleepEx, DELAY_SINPUT, TRUE<br>invoke keybd_event, VK_DOWN, NULL, KEYEVENTF_KEYUP, NULL<br>invoke SleepEx, DELAY_SINPUT, TRUE<br>invoke keybd_event, VK_RETURN, NULL, NULL, NULL<br>invoke SleepEx, DELAY_SINPUT, TRUE<br>invoke keybd_event, VK_RETURN, NULL, KEYEVENTF_KEYUP, NULL<br><br>; calculate the next tick<br>invoke GetTickCount<br>add eax, 1000<br>mov Timer_AutoChat, eax<br>.endif<br><br>ret<br><br>EventHandler_AutoChat endp<br><br>EventHandler_AutoLoot proc<br><br>; auto-loot<br>invoke keybd_event, NULL, Hotkey_AutoLoot_Key, KEYEVENTF_SCANCODE, NULL<br>invoke SleepEx, DELAY_SINPUT, TRUE<br>invoke keybd_event, NULL, Hotkey_AutoLoot_Key, KEYEVENTF_KEYUP or KEYEVENTF_SCANCODE, NULL<br><br>ret<br><br>EventHandler_AutoLoot endp<br><br>EventHandler_AutoPotionHP proc<br>LOCAL ScaleX<br>LOCAL ScaleY<br><br>.data<br>szMsg	db 1024 dup (?)<br>.code<br><br>; convert the coordinate from fullscreen to client rectangle<br>mov eax, AutoPotionHP_Alarm<br>add eax, 220<br>mov ScaleX, eax<br>mov ScaleY, 590<br>invoke ScaleToClientRect, addr ScaleX, addr ScaleY<br><br>; check the pixel color<br>invoke GetPixel, hDesktopDC, ScaleX, ScaleY<br>invoke ConvertToGreyscale, eax<br>xor ebx, ebx<br>.if eax == AUTOPOT_ALARM<br>mov ebx, TRUE<br>.elseif eax == AUTOPOT_ALARM2<br>mov ebx, TRUE<br>.endif<br>.if ebx != 0<br>; alarm is triggered<br>invoke keybd_event, NULL, Hotkey_HP_Potion, KEYEVENTF_SCANCODE, NULL<br>invoke SleepEx, DELAY_SINPUT, TRUE<br>invoke keybd_event, NULL, Hotkey_HP_Potion, KEYEVENTF_KEYUP or KEYEVENTF_SCANCODE, NULL<br>invoke Beep, 500, 10<br>.endif<br><br>ret<br><br>EventHandler_AutoPotionHP endp<br><br>EventHandler_AutoPotionMP proc<br>LOCAL ScaleX<br>LOCAL ScaleY<br><br>; convert the coordinate from fullscreen to client rectangle<br>mov eax, AutoPotionMP_Alarm<br>add eax, 328<br>mov ScaleX, eax<br>mov ScaleY, 590<br>invoke ScaleToClientRect, addr ScaleX, addr ScaleY<br><br>; check the pixel color<br>invoke GetPixel, hDesktopDC, ScaleX, ScaleY<br>invoke ConvertToGreyscale, eax<br>xor ebx, ebx<br>.if eax == AUTOPOT_ALARM<br>mov ebx, TRUE<br>.elseif eax == AUTOPOT_ALARM2<br>mov ebx, TRUE<br>.endif<br>.if ebx != 0<br>; alarm is triggered<br>invoke keybd_event, NULL, Hotkey_MP_Potion, KEYEVENTF_SCANCODE, NULL<br>invoke SleepEx, DELAY_SINPUT, TRUE<br>invoke keybd_event, NULL, Hotkey_MP_Potion, KEYEVENTF_KEYUP or KEYEVENTF_SCANCODE, NULL<br>invoke Beep, 500, 10<br>.endif<br><br>ret<br><br>EventHandler_AutoPotionMP endp<br><br>Client_SendCommand proc CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br><br>; send the specified command to the server<br>invoke SendMessageTimeout, HWND_BROADCAST, WM_SYSCOMMAND, CommandID, Argument, SMTO_BLOCK or SMTO_ABORTIFHUNG, 2000, NULL<br>ret<br><br>Client_SendCommand endp<br><br>Client_IncomingMessage proc CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL VKey:WORD<br><br>.if CommandID == MSPRO_SERVER_TESTPIPE<br>; respond with pipe OK message<br>invoke Client_SendCommand, MSPRO_CLIENT_STATE, MSPRO_STATE_PIPEOK<br>.endif<br><br>ret<br><br>Client_IncomingMessage endp<br><br>;-------------------<br>; Server-Side Codes<br>;-------------------<br><br>Server_SendCommand proc uses esi edi CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL lBytesWritten<br><br>; copy the command to buffer<br>mov esi, CommandID<br>mov edi, offset szBuffer<br>mov [edi], esi<br><br>; send the specified command to the client<br>invoke WriteFile, hPipeWrite, addr szBuffer, 4, addr lBytesWritten, FALSE<br>invoke SleepEx, 100, TRUE<br>ret<br><br>Server_SendCommand endp<br><br>Server_SendCommand2 proc uses esi edi CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL lBytesWritten<br><br>; copy the command to buffer<br>mov esi, CommandID<br>mov edi, offset szBuffer<br>mov [edi], esi<br><br>; copy the DWORD argument to buffer<br>mov esi, Argument<br>mov [edi + 4], esi<br><br>; send the specified command to the client<br>invoke WriteFile, hPipeWrite, addr szBuffer, 8, addr lBytesWritten, FALSE<br>invoke SleepEx, 100, TRUE<br>ret<br><br>Server_SendCommand2 endp<br><br>Server_SendCommand3 proc uses esi edi ebx CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, ArgSize<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL lBytesWritten<br><br>; copy the command to buffer<br>mov esi, CommandID<br>mov edi, offset szBuffer<br>mov [edi], esi<br><br>.if ArgSize &lt;= sizeof szBuffer - 4<br>; copy the string argument to buffer<br>invoke RtlMoveMemory, addr szBuffer + 4, Argument, ArgSize<br><br>; calculate the argument size<br>mov ebx, ArgSize<br>add ebx, 4<br><br>; send the specified command to the client<br>invoke WriteFile, hPipeWrite, addr szBuffer, ebx, addr lBytesWritten, FALSE<br>invoke SleepEx, 100, TRUE<br>.endif<br><br>ret<br><br>Server_SendCommand3 endp<br><br>Server_IncomingMessage proc CommandID<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD, Argument<img src="/images/emoticons/classic/icon_biggrin.gif" alt="Very Happy" title="Very Happy">WORD<br>LOCAL hProcess<br><br>.if CommandID == MSPRO_CLIENT_HANDLE<br>; open a handle to pipe creator process<br>invoke OpenProcess, PROCESS_DUP_HANDLE, FALSE, hPipePID<br>mov hProcess, eax<br><br>; duplicate the pipe write handle<br>invoke GetCurrentProcess<br>invoke DuplicateHandle, hProcess, Argument, eax, addr hPipeWrite, NULL, FALSE, DUPLICATE_SAME_ACCESS<br><br>; test the pipe<br>invoke Server_SendCommand, MSPRO_SERVER_TESTPIPE<br><br>.elseif CommandID == MSPRO_CLIENT_PID<br>; save the pipe creator process ID<br>push Argument<br>pop hPipePID<br><br>.elseif CommandID == MSPRO_CLIENT_STATE<br>; save the client state<br>push Argument<br>pop ConnState<br>.endif<br><br>ret<br><br>Server_IncomingMessage endp<br><br>end start<br><br><span style="color: brown;">mspro_v3.def</span><br>LIBRARY MSPro<br>EXPORTS MSPro_Initialize<br>EXPORTS MSPro_Finalize<br>EXPORTS MSPro_GetState<br>EXPORTS MSPro_SendKeystroke<br><br>EXPORTS MSPro_SetConfig1<br>EXPORTS MSPro_SetConfig2<br>EXPORTS MSPro_SetConfig3<br>EXPORTS MSPro_SetConfig4<br>EXPORTS MSPro_SetConfig5<br>EXPORTS MSPro_SetConfig6<br>EXPORTS MSPro_SetConfig7<br><br>; Tunnel functions<br>EXPORTS SendInput<br>EXPORTS GetPixel<br>EXPORTS keybd_event<br>EXPORTS mouse_event<br><span style="color: darkred;"><br>MSpro_v3.rap</span><br><br>[Project]<br>Assembler=masm<br>Type=Dll Project<br>Description=MSPro v3<br>Backup=$P\Bak\<br>Group=1<br>GroupExpand=1<br>Debug=0<br>[Files]<br>1=MSPro_v3.Asm<br>2=<br>3=MSPro_v3.Def<br>4=<br>[MakeFiles]<br>0=MSPro_v3.rap<br>1=MSPro_v3.rc<br>2=MSPro_v3.asm<br>3=MSPro_v3.obj<br>4=MSPro_v3.res<br>5=MSPro_v3.exe<br>6=MSPro_v3.def<br>7=MSPro_v3.dll<br>8=MSPro_v3.txt<br>9=MSPro_v3.lib<br>10=MSPro_v3.mak<br>11=MSPro_v3.hla<br>12=MSPro_v3.com<br>13=MSPro_v3.ocx<br>14=MSPro_v3.idl<br>15=MSPro_v3.tlb<br>[MakeDef]<br>Menu=0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0<br>1=4,O,$B\RC.EXE /v,1<br>2=3,O,$B\ML.EXE /c /coff /Cp /nologo /I"$I",2<br>3=7,O,$B\LINK.EXE /SUBSYSTEM:WINDOWS /RELEASE /DLL /DEF:$6 /LIBPATH:"$L" /OUT:"$7",3<br>4=0,0,,5<br>5=rsrc.obj,O,$B\CVTRES.EXE,rsrc.res<br>6=*.obj,O,$B\ML.EXE /c /coff /Cp /nologo /I"$I",*.asm<br>7=0,0,"$E\OllyDbg",5<br>11=4,O,$B\RC.EXE /v,1<br>12=3,O,$B\ML.EXE /c /coff /Cp /Zi /nologo /I"$I",2<br>13=7,O,$B\LINK.EXE /SUBSYSTEM:WINDOWS /DEBUG /DLL /DEF:$6 /LIBPATH:"$L" /OUT:"$7",3<br>14=0,0,,5<br>15=rsrc.obj,O,$B\CVTRES.EXE,rsrc.res<br>16=*.obj,O,$B\ML.EXE /c /coff /Cp /nologo /I"$I",*.asm<br>17=0,0,"$E\OllyDbg",5<br>[Group]<br>Group=Added files,Assembly,Resources,Misc,Modules<br>1=2<br>2=<br>3=4<br>4=<br>[Collapse]<br>4=<br>1=,,,<br>2=<br>3=<br>[Size]<br>4=0,0,0,0,224<br>1=0,0,0,0,16086<br>2=<br>3=0,0,0,0,403<br>[Find]<br>1="ConnState"<br>2="Redirect_Direct3DCreate8"<br>3="Hook_Direct3DCreate8"<br>4="ScreenToGameSpace"<br>5="KEYPRESS_DELAY"<br>6="BeepNotify"<br>7="Thread_GameMoniter"<br>8="Server_SendCommand"<br>9="MSPRO_STATE_CLOSED"<br>10="MSPRO_STATE_IDLE"<br>[VersionControl]<br>Settings=1246<br>Milestones=129<br>MilestoneEvery=10<br>MilestoneEveryCurrent=0<br>MilestoneOnBuild=0.0.0.0<br>MilestoneOnTime=2<br>MilestoneOnDate=0<br>MilestoneOnDateWhen=1<br>MilestoneOnDateStatus=0<br>MilestoneOnDateDate=7<br>MilestoneOnDateTimeYear=2006<br>MilestoneOnDateTimeMonth=4<br>MilestoneOnDateTimeDate=27<br>MilestoneOnDateTimeHour=21<br>MilestoneOnDateTimeMin=31<br>MilestoneOnDateTimeSec=49<br>MilestoneOnDateTimeStatus=0<br>BackupLocation=C:\RadASM\Masm\Projects\VCBackups\<br>CompressionLevel=0<br>DefaultComment=Project $N, $Z, Backup Created On $D At $T.<br>ExcludeExt1=\<br>ExcludeExt2=\<br>ExcludeExt3=\<br>ExcludeExt4=\<br>FileVerLength=4<br>FileVer2Range=0<br>FileVer3Range=0<br>FileVer4Range=0<br>ProductVerLength=4<br>ProductVer2Range=0<br>ProductVer3Range=0<br>ProductVer4Range=0<br>[Colref]<br>0=00FFFFFF<br>1=00FFFFFF<br>2=00FFFFFF<br>3=00FFFFFF<br>4=00FFFFFF<br>5=00FFFFFF<br>6=00FFFFFF<br>7=00FFFFFF<br>[BookMark]<br>0=<br>1=<br>2=<br>3=<br>4=<br>5=<br>6=<br>7=<br>8=<br>9=<br>[BreakPoint]<br>0=<br><br></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:22:32+00:00'>17 Mar 07, 23:22</time>
            </div>
            <div class='col-md body'><span style="color: orange;">prjmspro.vbp</span><br><br>Type=Exe<br>Form=frmMSPro.frm<br>Reference=*\G{00020430-0000-0000-C000-000000000046}#2.0#0#..\..\..\..\..\..\WINDOWS\System32\stdole2.tlb#OLE Automation<br>Class=Registry; clsRegistry.cls<br>IconForm="frmMSPro"<br>Startup="frmMSPro"<br>HelpFile=""<br>Title="MSPro"<br>ExeName32="MSPro.exe"<br>Command32=""<br>Name="MSPro"<br>HelpContextID="0"<br>CompatibleMode="0"<br>MajorVer=1<br>MinorVer=0<br>RevisionVer=0<br>AutoIncrementVer=0<br>ServerSupportFiles=0<br>CompilationType=-1<br>OptimizationType=0<br>FavorPentiumPro(tm)=0<br>CodeViewDebugInfo=0<br>NoAliasing=0<br>BoundsCheck=0<br>OverflowCheck=0<br>FlPointCheck=0<br>FDIVCheck=0<br>UnroundedFP=0<br>StartMode=0<br>Unattended=0<br>Retained=0<br>ThreadPerObject=0<br>MaxNumberOfThreads=1<br><br>[MS Transaction Server]<br>AutoRefresh=1<br><br><span style="color: red;">prjmspro.vbw</span><br><br>frmMSPro = 44, 58, 648, 488, Z, 22, 29, 626, 459, C<br>Registry = 44, 58, 647, 488, C<br><br></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:23:41+00:00'>17 Mar 07, 23:23</time>
            </div>
            <div class='col-md body'>oh , Mayi or other mods, i have a few kind of<br>files in the source code, so if u speicfy i can point it out 4 u<br>thx...  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-17T23:25:47+00:00'>17 Mar 07, 23:25</time>
            </div>
            <div class='col-md body'>It's in Visual Basic...<br><br>Read this site:<br><br><a href="http://www.freebyte.com/programming/compilers/envelop.html" rel="nofollow">http://www.freebyte.com/programming/compilers/envelop.html</a></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-17T23:26:43+00:00'>17 Mar 07, 23:26</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">oh , Mayi or other mods, i have a few kind of<br>files in the source code, so if u speicfy i can point it out 4 u<br>thx...  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"> </div></blockquote>All files are needed... short of one file, nothing will run.<br><br>If in doubt, just email the author.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:39:01+00:00'>17 Mar 07, 23:39</time>
            </div>
            <div class='col-md body'>the problem is, i dunoe how to edit!!!<br>the author wont entertain any Pms  <img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-17T23:40:27+00:00'>17 Mar 07, 23:40</time>
            </div>
            <div class='col-md body'>LOL<br><br>Just read the link I've provided...</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:43:12+00:00'>17 Mar 07, 23:43</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by ndmmxiaomayi:</div><div class="quote_body">LOL<br><br>Just read the link I've provided...</div></blockquote>help mi leh..i noob dunoe how<br><img src="/images/emoticons/classic/icon_mrgreen.gif" alt="Mr. Green" title="Mr. Green"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-17T23:53:16+00:00'>17 Mar 07, 23:53</time>
            </div>
            <div class='col-md body'>wa lao eh, mayi<br>i dl liao, load liao, i wan faint liao<br>I DUN EVEN NOE WTF IT IS 4  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>manyu882</div>
              <time class='date' datetime='2007-03-17T23:57:08+00:00'>17 Mar 07, 23:57</time>
            </div>
            <div class='col-md body'>computer language lai de la..<br><br>last time they talk with snake language <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-17T23:58:24+00:00'>17 Mar 07, 23:58</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">wa lao eh, mayi<br>i dl liao, load liao, i wan faint liao<br>I DUN EVEN NOE WTF IT IS 4  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing">  <img src="/images/emoticons/classic/icon_lol.gif" alt="Laughing" title="Laughing"> </div></blockquote>Then go and learn programming language.<br><br>Better still, go and download and install Microsoft Visual Studio.<br><br>It will solve your problem.</div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>yihao93</div>
              <time class='date' datetime='2007-03-18T00:01:12+00:00'>18 Mar 07, 00:01</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by ndmmxiaomayi:</div><div class="quote_body">Then go and learn programming language.<br><br>Better still, go and download and install Microsoft Visual Studio.<br><br>It will solve your problem.</div></blockquote>erm mayi, after reading my source code, do u noe how<br>to edit it to match the game?  <img src="/images/emoticons/classic/icon_rolleyes.gif" alt="Rolling Eyes" title="Rolling Eyes"></div>
          </div>
        </li>
        <li class='list-group-item post'>
          <div class='row'>
            <div class='col-md-2 meta'>
              <div class='author'>ndmmxiaomayi</div>
              <time class='date' datetime='2007-03-18T00:03:08+00:00'>18 Mar 07, 00:03</time>
            </div>
            <div class='col-md body'><blockquote><div class="quote_from">Originally posted by yihao93:</div><div class="quote_body">erm mayi, after reading my source code, do u noe how<br>to edit it to match the game?  <img src="/images/emoticons/classic/icon_rolleyes.gif" alt="Rolling Eyes" title="Rolling Eyes"> </div></blockquote>I don't play MS, you ask me, I don't know.</div>
          </div>
        </li>
      </ul>
      <nav class='pagination'>
        <a class='page-link' href='/forums/2250/topics/243020/2/'>Next</a>
      </nav>
      <footer>
        <nav class='nav'>
          <a class='nav-link' href='/'>Home</a>
          <a class='nav-link' href='/privacy/'>Privacy</a>
          <a class='nav-link' href='/terms/'>Terms</a>
        </nav>
      </footer>
    </div>
    <div id='div-gpt-ad-1528181032761-0' style='height:1px; width:1px;'><script>googletag.cmd.push(function(){googletag.display('div-gpt-ad-1528181032761-0');});</script></div>
  </body>
</html>
